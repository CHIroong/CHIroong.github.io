/*
메인 개편 GN 파일
20140414 이승환
20171204 이승환
20180221 전지호 - 통합검색연동
*/

// 사이트의 탄력적인 운영을 위해 host 주소, 변수로 분리 ( 2017-02-01 )
var HOST_DOMAIN = GetBasePath(window.location);

// 외부 도메인에서 사용되는 경우, 도메인 강제 고정
if (HOST_DOMAIN.toLowerCase().indexOf('tour.interpark.com') == -1)
    HOST_DOMAIN = 'http://tour.interpark.com';

// 검색 도메인에서 사용되는 경우, 도메인 강제 고정
if (HOST_DOMAIN.toLowerCase().indexOf('search-tour.interpark.com') > -1)
    HOST_DOMAIN = 'http://tour.interpark.com';

// IppCD
var ippcd = getCookie('ippcd');
var ippcdForSE = 'P14550';
var ippcdForInterpark = 'P14561';
var ippcdForSoulBrain = 'P14572';

var isSECustomer = false;
var isInterparkCustomer = false;
var isSoulBrainCustomer = false;

// 제휴사 고객 체크
if (ippcd == ippcdForSE)
    isSECustomer = true;
else if (ippcd == ippcdForInterpark)
    isInterparkCustomer = true;
else if (ippcd == ippcdForSoulBrain)
    isSoulBrainCustomer = true;

//메인페이지 판단
var strMain = "tour";

if (window.location.href == HOST_DOMAIN + '/'
    || window.location.href == HOST_DOMAIN
    || window.location.href.indexOf(HOST_DOMAIN + '/default.aspx') > -1
    || window.location.href.indexOf(HOST_DOMAIN + '/?') > -1)
    strMain = "tour_main";

var isHTTP = window.location.href.indexOf("http://") != -1;
var isHTTPS = window.location.href.indexOf("https://") != -1;

/* GNB통합검색-------------------------------------------------------------------------*/

var searchAdStr = new Array();
var searchAdUrl = new Array();
var searchStats = false;
var searchTxtStats = false;
var searchCount = 0;
var eventKeyUpInterval;
var lastEventKeyUpValue = "";
var isAutoComplete = false;
var isDisableAutoComplete = false;
var lastKeyword = "";
var onSelectAutoCompleteResult = new Array();
var isSelectAutoCompleteResult = 0;
var isFirefox = navigator.userAgent.toLowerCase().indexOf("firefox") > -1;

/* 배너-------------------------------------------------------------------------*/

var HellowSubImgSrcOn = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour/common/docu_head/rolling01_on.png");
var HellowSubImgSrcOff = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour/common/docu_head/rolling01_off.png");

var keywordCls = function () {
    this.arrSeq;
    this.arrkeyWord;
    this.arrkeyWordA;
    this.arrkeyWordB;
    this.arrLinkURL;
    this.arrImageURL;
    this.arrNewWindow;
};

SetKeyWord();

function _writeGNBArea() {

    var addonCss_gateway_wrap = '';

    // 제휴사 유입일 경우 ( 삼성전자, 솔브레인 ) 인터파크 부문 link 숨김
    if (isSECustomer || isSoulBrainCustomer)
        addonCss_gateway_wrap = 'samsungAlliance';
    
    var str = '';    
    str += '<div id="gateway_wrap" class="gateway-wrap ' + addonCss_gateway_wrap + '">';
    str += '    <div id="gateway_con" class="gateway-con">';
    str += '        <div class="gnbArea_left">';

    // 제휴사 유입일 경우 제휴사 유입일 경우 ( 삼성전자, 솔브레인 ) 인터파크 부문 link 숨김
    if (isSECustomer)
    {
        str += '<span class="samsungAllianceTitle">';
        str += '    <img src="http://openimage.interpark.com/tourpark/tour_ui/common/gateway/samsung_allianceTitle.png" alt="삼성전자 임직원 전용 여행몰">';
        str += '</span>';
    }
    else if (isSoulBrainCustomer) {
        str += '<span class="samsungAllianceTitle">';
        str += '    <img src="http://openimage.interpark.com/tourpark/tour/soulbrain/soulbrainTitle.png" alt="솔브레인 임직원 전용 여행몰">';
        str += '</span>';
    }
    else {

        str += '            <ul>';
        str += '                <li class="home">';
        str += '                    <a href="http://www.interpark.com?mbn=tour&mln=int" title="클릭 시 인터파크 메인 페이지로 이동합니다.">홈</a>';
        str += '                </li>';
        //str += '                <li class="shopping">';
        //str += '                    <a href="#" title="클릭 시 인터파크 쇼핑 메인 페이지로 이동합니다.">쇼핑</a>';
        //str += '                </li>';
        str += '                <li class="book">';
        str += '                    <a href="http://book.interpark.com?mbn=tour&mln=book" title="클릭 시 인터파크 도서 메인 페이지로 이동합니다.">도서</a>';
        str += '                </li>';
        str += '                <li class="ticket">';
        str += '                    <a href="http://ticket.interpark.com?mbn=tour&mln=ticket" title="클릭 시 인터파크 티켓 메인 페이지로 이동합니다.">티켓</a>';
        str += '                </li>';
        str += '                <li class="tour">';
        str += '                    <a href="' + HOST_DOMAIN + '?mbn=tour&mln=tour" title="클릭 시 인터파크 투어 메인 페이지로 이동합니다.">투어바로가기</a>';
        str += '                </li>';
        str += '                <li class="imarket">';
        str += '                    <a href="https://incorp.interpark.com/member/extern.do?_method=imkSsoGate&reqSite=20&RETURN_URL=http%3A%2F%2Fwww.imarket.co.kr%2Fdisplay%2Fmalls.do%3F_method%3Dwelcome" title="클릭 시 인터파크 아이마켓 메인 페이지로 이동합니다." target="_blank">아이마켓</a>';
        str += '                </li>';
        str += '            </ul>';        
    }
    str += '        </div>';

    str += '        <div id="topGateBanner">';
    str += '        </div>';

    str += '        <div class="gnbArea_right">';
    str += '            <ul>';

    if (getLoginYN() == "Y" || getAutoLoginYN() == "Y" || hasAlKey() == "Y") {

        str += '                <li id="liLoginStatus" class="first logon">';
        str += '                    <a id="aLoginMember" href="javascript:goLogoutGN();">로그아웃</a>';
        str += '                </li>';
        str += '                <li id="liLoginMemberInfo">';
        str += '                    <a href="http://incorp.interpark.com/member/memberjoin.do?_method=upMemberFront&mbn=tour&mln=main_join">회원정보</a>';
        str += '                </li>';

    }
    else {

        str += '                <li class="first">';
        str += '                    <a id="aMemberName" href="javascript:goLoginGN();">로그인</a>';
        str += '                </li>';

        var signUpUrl = 'https://incorp.interpark.com/member/memberjoinclause.do?_method=initial&reqSite=TOUR&mbn=tour&mln=main_join';

        // 제휴사(삼성전자, 솔브레인) 유입일 경우 회원 가입 페이지 URL 을 Default 에서 제휴사 전용으로 변경
        if (isSECustomer)
            signUpUrl = 'https://incorp.interpark.com/member/memberjoin.do?_method=initialPartner&partnerTp=SAMSUNG';
        else if (isSoulBrainCustomer)
            signUpUrl = 'http://www.interpark.com/gate/ippgw.jsp?biz_cd=P14572&url=https://incorp.interpark.com/member/memberjoin.do?_method=initialPartner&partnerTp=SOULBRAIN';

        str += '                <li>';
        str += '                    <a href="' + signUpUrl + '">회원가입</a>';
        str += '                </li>';

    }
    str += '                <li class="bul" onmouseover="show_glayer(\'dlmypgsub\');" onmouseout="hide_glayer(\'dlmypgsub\');">';
    str += '                    <a ga:ca="PWC-Main" ga:ac="마이페이지 상단 서비스 영역" href="' + HOST_DOMAIN + '/mypage/Default.aspx?mbn=' + strMain + '&mln=tour_mypage" onfocus="show_glayer(\'dlmypgsub\');">마이페이지</a>';
    str += '                    <div class="mypgsub" id="dlmypgsub" style="display:none;" onmouseover="show_glayer(\'dlmypgsub\');" onmouseout="hide_glayer(\'dlmypgsub\');">';
    str += '                        <ul class="list">';
    str += '                            <li><a href="' + HOST_DOMAIN + '/mypage/Default.aspx?mbn=' + strMain + '&mln=tour_reservation">예약확인/취소</a></li>';
    str += '                            <li><a href="' + HOST_DOMAIN + '/mypage/myInquiry_list.aspx?mbn=' + strMain + '&mln=tour_consult">나의 문의내역</a></li>';
    str += '                            <li><a href="' + HOST_DOMAIN + '/mypage/wishlist.aspx?mbn=' + strMain + '&mln=tour_good" onblur="hide_glayer(\'dlmypgsub\');">내가 찜한상품</a></li>';
    str += '                        </ul>';
    str += '                    </div>';
    str += '                </li>';
    str += '                <li class="bul" onmouseover="show_glayer(\'dlcussub\');" onmouseout="hide_glayer(\'dlcussub\');">';
    str += '                    <a href="' + HOST_DOMAIN + '/customer/?mbn=' + strMain + '&mln=tour_custom" onfocus="show_glayer(\'dlcussub\');">고객센터</a>';
    str += '                    <div class="customersub" id="dlcussub" style="display: none;" onmouseover="show_glayer(\'dlcussub\');" onmouseout="hide_glayer(\'dlcussub\');">';
    str += '                        <ul class="list">';
    str += '                            <li><a href="' + HOST_DOMAIN + '/customer/noticelist.aspx?mbn=' + strMain + '&mln=tour_notice">공지사항</a></li>';
    str += '                            <li><a href="' + HOST_DOMAIN + '/customer/faq.aspx?mbn=' + strMain + '&mln=tour_faq">자주묻는질문</a></li>';
    str += '                            <li><a href="javascript:ExcuteTalkEnterModule();">여행톡집사</a></li>';
    str += '                            <li><a href="' + HOST_DOMAIN + '/category/myvisa/main.aspx?mbn=' + strMain + '&mln=tour_visa">인터파크 비자센터</a></li>';
    str += '                            <li><a href="' + HOST_DOMAIN + '/category/insurance/main.aspx?mbn=' + strMain + '&mln=tour_lig">여행자보험</a></li>';
    str += '                            <li><a href="' + HOST_DOMAIN + '/customer/creditcard01.aspx?mbn=tour&mln=tour_card" onblur="hide_glayer(\'dlcussub\');">무이자할부</a></li>';
    str += '                        </ul>';
    str += '                    </div>';
    str += '                </li>';

    if (isSECustomer) {
        str += '            <li class="samsungBenefitsGuide"><a href="' + HOST_DOMAIN + '/Partner/SE">삼성전자 임직원 혜택안내</a></li>';
    }
    else if (isInterparkCustomer) {
        str += '            <li><a href="' + HOST_DOMAIN + '/Partner/Interpark" style="color:#e25147 !important;">인터파크 임직원 혜택안내</a></li>';
    }
    else if (isSoulBrainCustomer) {
        str += '            <li><a href="' + HOST_DOMAIN + '/Partner/SoulBrain" style="color:#e25147 !important;">솔브레인 임직원 혜택안내</a></li>';
    }
    else {

        str += '            <li><a href="http://mobile.interpark.com?mbn=' + strMain + '&mln=main_mobile_2#TOUR">모바일 App</a></li>';
        str += '            <li><a href="' + HOST_DOMAIN + '/corp/?mbn=tour&mln=main_corp">법인/상용</a></li>';
    }
    str += '            </ul>';
    str += '        </div>';    
    str += '    </div>';
    str += '</div>';    
    
    str += '<div class="tour-header">';
    str += '    <div class="search-area">';
    str += '        <h1 class="logo-box">';

    // 제휴사(삼성전자, 솔브레인) 유입일 경우, 검색라인 로고를 모두 투어로 설정 / GA link 도 각 상황에 맞게 분기 처리
    var logLinkForLogoLine = 'http://www.interpark.com/malls/index.html';
    var gaLinkForLogoLine = 'www.interpark.com';
    if (isSECustomer || isSoulBrainCustomer) {
        logLinkForLogoLine = HOST_DOMAIN + '/?mbn=' + strMain + '&mln=tour_tour';
        gaLinkForLogoLine = 'tour.interpark.com';
    }
    
    str += '            <a href="' + HOST_DOMAIN + '/?mbn=' + strMain + '&mln=tour_tour" class="tour" title="인터파크 투어 메인 바로가기">';
    str += '                <span>인터파크 투어</span>';
    str += '            </a>';
    str += '            <a href="' + logLinkForLogoLine + '" class="interpark" title="인터파크 메인 바로가기">';
    str += '                <span>인터파크</span>';
    str += '            </a>';
    str += '        </h1>';
        
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = '//search-tour.interpark.com/DistPC/searchBarModule.js';
    head.appendChild(script);

    setTimeout(function () {
        //조금대기        
    }, 1000);

    str += '<form class="search-box" role="search" onsubmit="return false;">';
    str += '<h2 class="blind">검색</h2>';
    str += '    <fieldset>';
    str += '        <legend class="blind">검색영역</legend>';
    str += '        <label id="box" class="search-wrap">';
    //str += '            <input type="text" style="display: none;">';
    //str += '            <input type="search" id="SearchGNBText" name="SearchGNBText"';
    //str += '                   autocorrect="off"';
    //str += '                   autocapitalize="off"';
    //str += '                   autocomplete="off"';
    //str += '                   onkeyup="searchBarModule.AutoComplete(this, event);" />';
    str += '        </label>';
    str += '        <!-- 자동완성 및 최근인기검색어 -->';
    str += '';
    str += '        <!-- 자동완성영역 -->';
    str += '        <div class="autoComBox" role="combobox" aria-label="자동완성검색어">';
    str += '        </div>';
    str += '';
    str += '        <!-- 최근검색어영역 -->';
    str += '        <div class="seaQueryBox">';
    str += '        </div>';
    str += '';
    str += '        <button class="search-btn" type="button" onclick="searchBarModule.ClickForSearch();" title="검색">검색</button>';
    str += '        <button class="recent-btn" type="button" onclick="searchBarModule.HotKeyUpdate();" title="최근검색어" >최근검색어 열기</button>';
    str += '    </fieldset>';
    str += '</form>';

    //str += '        <div name="SearchGNBFrom" id="SearchGNBFrom" autocomplete="off" class="search-box" role="search">';
    //str += '            <h2 class="blind">검색</h2>';
    //str += '            <fieldset>';
    //str += '                <legend class="blind">검색영역</legend>';
    //str += '                <label id="box" class="search-wrap">';
    //str += '                </label>';
    //str += '		        <div id="AutoComplete" style="display:none;top: 37px;left: -2px; position:absolute; z-index:99999;" ></div>';
    //str += '                <div id="SearchWord" style="position: absolute; top: 37px;left: -2px; z-index: 99999; display: none;"></div>';
    //str += '                <button type="button" id="scbt" class="search-btn" title="검색" onclick="SearchGNBArea(\'N\');" >검색</button>';
    //str += '                <button type="button" class="recent-btn" onclick="toggleAutoComplete();" title="최근검색어 열기">최근검색어 열기</button>';
    //str += '            </fieldset>';
    //str += '        </div>';

    str += '        <div class="spot-banner-box">';
    str += '            <a href="' + HOST_DOMAIN + '/freeya/?mbn=' + strMain + '&mln=tour_freeya">프리야<br>여행정보</a>';
    str += '        </div>';

    str += '        <div id="GNBRollingBanner" class="banner-box doing">';    
    str += '        </div>';

    str += '        <div id="GNBFloatingBanner" class="left-side-banner">';    
    str += '        </div>';
    str += '    </div>';

    str += '    <div class="menu-area">';
    str += '        <h2 class="blind">';
    str += '            <a href="#" id="mainMenu">메뉴</a>';
    str += '        </h2>';
    str += '        <div class="gnb-box overseas">';
    //str += '            <h3 class="blind">인터파크 해외여행</h3>';
    str += '            <dl class="gnb-grid">';
    str += '                <dt><h3>해외</h3></dt>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="oAir">';
    str += '                    <h4>';
    str += '                        <a href="http://air.interpark.com/?mbn=' + strMain + '&mln=tour_air" title="항공 바로가기" onfocus="focusMenu(this)">항공</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 해외항공</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>스페셜 프라이스</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/DiscountCity.lts?method=init&fareType=M&cityCode=NRT&natOrder=1&mbn=' + strMain + '&mln=air_menu_01"><span>주요도시 할인항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/ClosingSaleFareSub.lts?mbn=' + strMain + '&mln=air_menu_04"><span>오늘의 항공특가</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/airticket/overseas/main.aspx?mbn=' + strMain + '&mln=air_menu_05"><span>땡처리 항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/DiscountCity.lts?method=init&fareType=H&cityCode=NRT&natOrder=1&mbn=' + strMain + '&mln=air_menu_02"><span>모바일 항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/DiscountCity.lts?method=init&fareType=D&cityCode=NRT&natOrder=1&mbn=' + strMain + '&mln=air_menu_03"><span>부산출발 항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong>맞춤 항공권</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/DiscountCity.lts?method=init&fareType=S&cityCode=NRT&natOrder=1&mbn=' + strMain + '&mln=air_menu_07"><span>학생할인 항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/DiscountCity.lts?method=init&fareType=P&cityCode=NRT&natOrder=1&mbn=' + strMain + '&mln=air_menu_08"><span>지방출발 항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://air.interpark.com/lts/booking/DiscountCity.lts?method=init&fareType=B&cityCode=NRT&natOrder=1&mbn=' + strMain + '&mln=air_menu_06"><span>비지니스 클래스</span></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/Airtel/Main.aspx?mbn=' + strMain + '&mln=main_menuair8"><strong>항공+호텔</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/customer/fitconsultwrite.aspx?code=Corp&ConsultType=0&mbn=' + strMain + '&mln=main_menuair9"><strong>단체호텔문의</strong></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_20"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="oHotel">';
    str += '                    <h4>';
    str += '                        <a href="http://hotel.interpark.com/?mbn=' + strMain + '&mln=tour_hotel" title="호텔 바로가기" onfocus="focusMenu(this)">호텔</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 해외호텔</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="http://hotel.interpark.com/Category/Ranking.aspx?mbn=' + strMain + '&mln=main_menuhotel2" ><strong>해외호텔 지역별 랭킹</strong></a>';
    str += '                            </p>';    
    str += '                            <p class="emphasis">';
    str += '                                <strong>핫이슈! 지역별</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAIBOAAQ&mbn=' + strMain + '&mln=main_menuhotel16"><span>도쿄 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAIBGAAQ&mbn=' + strMain + '&mln=main_menuhotel18"><span> 오사카 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAIAGAAF&mbn=' + strMain + '&mln=main_menuhotel17"><span> 후쿠오카</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAIAVAAL&mbn=' + strMain + '&mln=main_menuhotel19"><span>교토 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAIALABF&mbn=' + strMain + '&mln=main_menuhotel21"><span> 삿포로 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAIBFAAA&mbn=' + strMain + '&mln=main_menuhotel20"><span> 오키나와</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAFAAAAA&mbn=' + strMain + '&mln=main_menuhotel22"><span>홍콩 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAMAAAAA&mbn=' + strMain + '&mln=main_menuhotel23"><span> 마카오 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAXAAACV&mbn=' + strMain + '&mln=main_menuhotel24"><span> 타이페이</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAUAAAAA&mbn=' + strMain + '&mln=main_menuhotel25"><span>싱가포르 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CATAAABY&mbn=' + strMain + '&mln=main_menuhotel26"><span> 세부 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAZAAABU&mbn=' + strMain + '&mln=main_menuhotel27"><span> 방콕</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAZAAAKZ&mbn=' + strMain + '&mln=main_menuhotel28"><span>푸켓 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=CAHAAAAO&mbn=' + strMain + '&mln=main_menuhotel29"><span> 발리 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=DAIAAAAR&mbn=' + strMain + '&mln=main_menuhotel30"><span> 괌</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=IADALAAT&mbn=' + strMain + '&mln=main_menuhotel31"><span>하와이(호놀룰루) </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=IADBJAPR&mbn=' + strMain + '&mln=main_menuhotel32"><span> 뉴욕</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=IADAEANO&mbn=' + strMain + '&mln=main_menuhotel33"><span>로스앤젤레스 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=IADBFABE&mbn=' + strMain + '&mln=main_menuhotel34"><span> 라스베가스</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=IADAEAVG&mbn=' + strMain + '&mln=main_menuhotel35"><span>샌프란시스코</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=FARAAGQV&mbn=' + strMain + '&mln=main_menuhotel36"><span>파리 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=FBYADASZ&mbn=' + strMain + '&mln=main_menuhotel37"><span> 런던 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=FBSAAAKI&mbn=' + strMain + '&mln=main_menuhotel38"><span> 바르셀로나</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=FAZAADUN&mbn=' + strMain + '&mln=main_menuhotel39"><span>로마 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=FALAAANQ&mbn=' + strMain + '&mln=main_menuhotel40"><span> 프라하 </span></a>';
    str += '                                <a href="http://hotel.interpark.com/Category/D3.aspx?CityCD=&RegionCode=FBVAAALJ&mbn=' + strMain + '&mln=main_menuhotel41"><span> 인터라켄</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong>관광서비스</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/669/?freecd=669&mbn=' + strMain + '&mln=main_menuhotel46"><span>티켓/현지투어</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://www.rentalcars.com/Home.do?affiliateCode=interpark_rc&cor=kr&adplat=abroadhoteldropdown"><span>해외랜터카</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://eurail.interpark.com/ASPX/EurailProducts/EurailProducts.aspx?SID=ITP01-02&mbn=' + strMain + '&mln=main_menuhotel47"><span>유레일패스</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://tour.interpark.com/event/event_view.aspx?seq=11125" target="_blank" ><span>해외공항픽업</span></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>테마별</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=7352&mbn=' + strMain + '&mln=main_menuhotel13"><span>싱글족 호텔 </span></a>';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=6655&mbn=' + strMain + '&mln=main_menuhotel3"><span> 일본료칸</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=7541&mbn=' + strMain + '&mln=main_menuhotel42"><span>허니문 </span></a>';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=7351&mbn=' + strMain + '&mln=main_menuhotel12"><span> 럭셔리 호텔</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://hotel.interpark.com/category/maldives.aspx?mbn=' + strMain + '&mln=main_menuhotel4"><span>몰디브 휴양리조트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=7324&mbn=' + strMain + '&mln=main_menuhotel5"><span>스페셜 칸쿤리조트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/668/?freecd=668&mbn=' + strMain + '&mln=main_menuhotel48"><span>크루즈</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong>해외호텔 전용 혜택</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=10330&mbn=' + strMain + '&mln=main_menuhotel43"><span>10박하면 1박 무료!</span></a>';    
    str += '                            </p>';
    str += '                            <p class="normal">';    
    str += '                                <a href="http://overseahotel.interpark.com/?mbn=' + strMain + '&mln=main_menuhotel14"><span>당일예약&현지결제</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/Airtel/Main.aspx?mbn=' + strMain + '&mln=tour_airhotel"><strong>항공+호텔</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/customer/noticelist.aspx?PageNum=1&class=101&Gubun=Title&keyWord="><strong>NOTICE(공지사항)</strong></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_21"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="oPackage">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/package/main/?mbn=' + strMain + '&mln=tour_pkg" title="패키지 바로가기" onfocus="focusMenu(this)">패키지</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 패키지</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>동남아</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/21/?mbn=' + strMain + '&mln=main_menupkg1"><span>태국(방콕,푸켓,크라비)</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/3774/?mbn=' + strMain + '&mln=main_menupkg22"><span>베트남(다낭,하노이,호치민)</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/3775/?mbn=' + strMain + '&mln=main_menupkg23"><span>캄보디아(앙코르왓)/라오스</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/1969/?mbn=' + strMain + '&mln=main_menupkg17"><span>필리핀(세부,보홀,팔라완)</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/1974/?mbn=' + strMain + '&mln=main_menupkg18"><span>코타/쿠알라/발리/싱가폴</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/3989/?packagecd=3989&mbn=' + strMain + '&mln=pkg_menu_8"><span>홍콩/마카오/대만</span></a>';
    str += '                            </p>';    
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/23/?mbn=' + strMain + '&mln=main_menupkg4"><strong>중국</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/22/?mbn=' + strMain + '&mln=main_menupkg2"><strong>일본</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong>유럽</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';    
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/2404/?mbn=' + strMain + '&mln=main_menupkg17"><span>서유럽</span></a>';    
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/7608/?mbn=' + strMain + '&mln=main_menupkg30"><span>스페인/지중해/북유럽</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/25/?mbn=' + strMain + '&mln=main_menupkg5"><span>동유럽/발칸/두바이</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong>남태평양</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/24/?mbn=' + strMain + '&mln=main_menupkg3"><span>괌/사이판/팔라우</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/160/?mbn=' + strMain + '&mln=main_menupkg7"><span>호주/뉴질랜드/남태평양</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/27/?mbn=' + strMain + '&mln=main_menupkg6"><strong>미국/캐나다/중남미</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/5819/?mbn=tour&mln=main_menupkg28"><strong>인도/네팔/스리랑카</strong></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/3257/?mbn=tour&mln=main_menupkg21"><strong>부산출발</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2r/5983/?mbn=tour&mln=main_menupkg29"><strong>대구출발</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/3179/?mbn=' + strMain + '&mln=main_menupkg19" data-alert="true"><strong>맞춤패키지</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/1590/?mbn=' + strMain + '&mln=main_menupkg13"><strong>홈쇼핑 히트상품</strong></a>';
    str += '                            </p>';    
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/3180/?mbn=' + strMain + '&mln=main_menupkg20"><strong>프리미엄패키지</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/2786/?mbn=' + strMain + '&mln=main_menupkg25"><strong>골프</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/3798/?mbn=' + strMain + '&mln=main_menupkg24"><strong>풀빌라패키지</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/1093/?mbn=' + strMain + '&mln=main_menupkg27"><strong>해외크루즈</strong></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_23"></div>';
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="oFree">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/free/main/?mbn=' + strMain + '&mln=tour_free" title="자유여행 바로가기" onfocus="focusMenu(this)">자유여행</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 자유여행</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/26/?freecd=26&mbn=' + strMain + '&mln=main_menufree1"><strong>홍콩/마카오/대만</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/35/?freecd=35&mbn=' + strMain + '&mln=main_menufree2"><strong>방콕/푸켓/코사무이</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/2341/?freecd=2341&mbn=' + strMain + '&mln=main_menufree16"><strong>라오스/캄보디아/베트남</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/2083/?freecd=2083&mbn=' + strMain + '&mln=main_menufree17"><strong>싱가포르</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/3613/?freecd=3613&mbn=' + strMain + '&mln=main_menufree18"><strong>발리/코타/쿠알라/페낭</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/31/?freecd=31&mbn=' + strMain + '&mln=main_menufree3"><strong>필리핀(세부,보홀,팔라완)</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/1409/?freecd=1409&mbn=' + strMain + '&mln=main_menufree4"><strong>중국</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/29/?freecd=29&mbn=' + strMain + '&mln=main_menufree5"><strong>일본</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/33/?freecd=33&mbn=' + strMain + '&mln=main_menufree7"><strong>괌/사이판</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/721/?freecd=721&mbn=' + strMain + '&mln=main_menufree8"><strong>호주/뉴질랜드</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/911/?freecd=911&mbn=' + strMain + '&mln=main_menufree11"><strong>몰디브/모리셔스/칸쿤</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/32/?freecd=32&mbn=' + strMain + '&mln=main_menufree13"><strong>유럽/두바이</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/495/?freecd=495&mbn=' + strMain + '&mln=main_menufree9"><strong>미국/캐나다/중남미</strong></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/1253/?freecd=1253&mbn=' + strMain + '&mln=main_menufree10"><strong>하와이</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/3287/?freecd=3287&mbn=' + strMain + '&mln=main_menufree15" data-alert="true"><strong>부산출발</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/669/?freecd=669&mbn=' + strMain + '&mln=main_menufree12"><strong>티켓/현지투어</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="http://www.rentalcars.com/Home.do?affiliateCode=interpark_rc&cor=kr&adplat=individualtourdropdown" target="_blank"><strong>해외렌터카</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="https://interpark.pickupscanner.com/?from=inparktour" target="_blank"><strong>해외공항픽업</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d3/3826/?freecd=3826&mbn=' + strMain + '&mln=main_menufree19"><strong>풀빌라 자유여행</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/resort/clubmed/?mbn=' + strMain + '&mln=main_menufree20"><strong>클럽메드</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/668/?freecd=668&mbn=' + strMain + '&mln=main_menufree21"><strong>해외크루즈</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="http://eurail.interpark.com/ASPX/EurailProducts/EurailProducts.aspx?SID=ITP01-02"><strong>유레일패스</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/Airtel/Main.aspx?mbn=' + strMain + '&mln=tour_airhotel"><strong>항공+호텔</strong></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_22"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="oTheme" data-alert="true">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/tourarea/?mbn=' + strMain + '&mln=tour_mall" title="테마여행 바로가기" onfocus="focusMenu(this)">테마여행</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 테마여행</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>상품별</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/2786/?mbn=' + strMain + '&mln=main_menupkg25"><strong>골프</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/exhibition/calendar.aspx?cate=305&mbn=tourexhibit&mln=exhibit_left_menu1"><strong>해외박람회</strong></a>';    
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d2t/1093/?mbn=' + strMain + '&mln=main_menupkg27"><strong>크루즈</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://tourarea.interpark.com/MallE/Canadalist?mallcd=191&cate=6750&mall1=canada&mall2=canada_gn_1_2"><strong>오로라</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=9825&mbn=' + strMain + '&mln=clubmed_special_1"><strong>스키</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/honey?mbn=' + strMain + '&mln=dm_honey"><strong>허니문</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/resort/clubmed/?mbn=' + strMain + '&mln=main_menumall7"><strong>클럽메드</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/resort/pic/?mbn=' + strMain + '&mln=main_menumall8"><strong>PIC</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/mall/?mallcd=171&mbn=' + strMain + '&mln=main_menumall12"><strong>일본료칸</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/free/d2/669?mbn=' + strMain + '&mln=main_menufree12"><strong>티켓/현지투어</strong></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>지역별</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://tourarea.interpark.com/mallE/main?mallcd=7607&mbn=' + strMain + '&mln=main_menumall14" data-alert="true"><strong>베트남</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://tourarea.interpark.com/mallE/main?mallcd=191&mbn=' + strMain + '&mln=main_menumall1" data-alert="true"><strong>캐나다</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://tourarea.interpark.com/mallE/main?mallcd=121&mbn=' + strMain + '&mln=main_menumall2" data-alert="true"><strong>마카오</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="http://tourarea.interpark.com/mallE/main?mallcd=119&mbn=' + strMain + '&mln=main_menumall3" data-alert="true"><strong>호주</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/mallE/main?mallcd=101&mbn=' + strMain + '&mln=main_menumall4"><strong>두바이</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/mall/?mallcd=404&mbn=' + strMain + '&mln=main_menumall5"><strong>싱가포르</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/mall/?mallcd=173&mbn=' + strMain + '&mln=main_menumall6"><strong>하와이</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/mall/?mallcd=164&mbn=' + strMain + '&mln=main_menumall9"><strong>몰디브</strong></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/mall/?mallcd=172&mbn=' + strMain + '&mln=main_menumall10"><strong>모리셔스/세이셸</strong></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_36"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '            </dl>';
    str += '        </div>';
    str += '        <div class="gnb-box domestic">';
    //str += '            <h3 class="blind">인터파크 국내여행</h3>';
    str += '            <dl class="gnb-grid">';
    str += '                <dt>';
    str += '                    <h3>국내</h3>';
    str += '                </dt>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="dAir">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/airticket/domestic/main.aspx?mbn=' + strMain + '&mln=tour_Dair" title="항공 바로가기" onfocus="focusMenu(this)">항공</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 국내항공</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="http://domair.interpark.com/dom/main.do?mbn=' + strMain + '&mln=main_menuDair5" data-alert="true"><strong>국내실시간 항공 예약</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/airticket/domestic/main.aspx?mbn=' + strMain + '&mln=main_menuDair2"><strong>땡처리 할인 항공권</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/freeya/jeju/intro.aspx?mbn=' + strMain + '&mln=main_menuDair3"><strong>제주 여행만들기</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/rentcar?mbn=' + strMain + '&mln=main_menuDair4"><strong>제주 렌터카</strong></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div id="subMenu_24" class="menu">';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="dAccommo" data-alert="true">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/housing/category/Hotel_Main.aspx?mbn=' + strMain + '&mln=tour_housing" title="숙박 바로가기" onfocus="focusMenu(this)">숙박</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 국내숙박</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong><a href="' + HOST_DOMAIN + '/housing/category/Hotel_Main.aspx?mbn=' + strMain + '&mln=tour_Dhotel">호텔</a></strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/event/NewHousing.aspx" data-alert="true"><span>신규숙박지</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=043&CateCD=299&mbn=' + strMain + '&mln=main_menuDhotel20"><span>부티크</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=042&CateCD=299&mbn=' + strMain + '&mln=main_menuDhotel16"><span>게스트하우스</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=020&CateCD=291&mbn=' + strMain + '&mln=main_menuDhotel1"><span>레지던스</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=041&CateCD=291&mbn=' + strMain + '&mln=main_menuDhotel17"><span>골프리조트&amp;골프텔</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=030&CateCD=295&mbn=' + strMain + '&mln=main_menuDhotel3"><span>공항인근숙박</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=032&CateCD=296&mbn=' + strMain + '&mln=main_menuDhotel5"><span>제주추천숙박</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=039&CateCD=299&mbn=' + strMain + '&mln=main_menuDhotel19"><span>글램핑/카라반</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=022&CateCD=294&mbn=' + strMain + '&mln=main_menuDhotel18"><span>일출/바다</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=038&CateCD=299&mbn=' + strMain + '&mln=main_menuDhotel4"><span>베니키아호텔</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong><a href="' + HOST_DOMAIN + '/housing/category/Condo_Main.aspx?mbn=' + strMain + '&mln=tour_condo"">리조트</a></strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Information/Condo_Chain_Master.aspx?Type=CHAIN&chainCD=01&mbn=' + strMain + '&mln=main_menucon2"><span>체인별 리조트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/AreaList.aspx?LMC=C&PV=AD001&mbn=' + strMain + '&mln=main_menucon1"><span>지역별 리조트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=041&CateCD=291&mbn=' + strMain + '&mln=main_menucon_golf"><span>골프리조트&amp;골프텔</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=7296&mbn=' + strMain + '&mln=main_menucon_water"><span>스파&amp;워터파크 리조트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=9246&mbn=' + strMain + '&mln=main_menucon_ski"><span>스키장 리조트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=8491&mbn=' + strMain + '&mln=main_menucon_top"><span>리조트 TOP 10</span></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong><a href="' + HOST_DOMAIN + '/housing/Category/Pension_Main.aspx?HousingTypefirst=P&mbn=' + strMain + '&mln=tour_pension"">펜션</a></strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=5607&mbn=' + strMain + '&mln=main_menupen_swim"><span>수영장 펜션</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=9570&mbn=' + strMain + '&mln=main_menupen_sea"><span>바다전망 펜션</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=6673&mbn=' + strMain + '&mln=main_menupen_spa"><span>스파/월풀 펜션</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=4750&mbn=' + strMain + '&mln=main_menupen_secret"><span>독채 펜션</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=9370&mbn=' + strMain + '&mln=main_menupen_camp"><span>글램핑&amp;카라반</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=042&CateCD=299&mbn=' + strMain + '&mln=main_menupen_guest"><span>게스트하우스</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=8654&mbn=' + strMain + '&mln=main_menupen_best"><span>펜션 TOP 10</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/event/event_view.aspx?seq=8296&mbn=' + strMain + '&mln=main_menupen_pre"><span>프리미엄 펜션</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong><a href="' + HOST_DOMAIN + '/housing/category/Voucher_Main.aspx?CateCD=030&mbn=' + strMain + '&mln=dm_voucher">이용권</a></strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?PageGubun=033&CateCD=297&CateCD=297&mbn=' + strMain + '&mln=main_menuDvoucherSpa"><span>스파/테라피</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?PageGubun=040&CateCD=297&CateCD=297&mbn=' + strMain + '&mln=main_menuDvoucherRestaurant"><span>뷔페/레스토랑</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?PageGubun=036&CateCD=299&CateCD=298&mbn=' + strMain + '&mln=main_menuDvoucherTicket"><span>관광지/레저</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?PageGubun=037&CateCD=299&CateCD=298&mbn=' + strMain + '&mln=main_menuDvoucherWater"><span>워터파크/온천</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?PageGubun=035&CateCD=299&CateCD=299&mbn=' + strMain + '&mln=main_menuDvoucherCruise"><span>유람선/요트</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?PageGubun=044&CateCD=299&CateCD=299&mbn=' + strMain + '&mln=main_menuDvoucherCruise"><span>배낚시</span></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_25" class="ad-banner"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="dJeju">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/jeju/main/?mbn=' + strMain + '&mln=tour_jeju" title="제주도 바로가기" onfocus="focusMenu(this)">제주도</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 제주도</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>개별예약</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/freeya/jeju/intro.aspx?mbn=' + strMain + '&mln=main_menujeju1" data-alert="true"><span>제주 여행만들기</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/airticket/domestic/main.aspx?mbn=' + strMain + '&mln=main_menujeju2"><span>국내 항공권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/AreaList.aspx?PV=A4006&mbn=' + strMain + '&mln=jeju_lefthotel"><span>호텔 </span></a>';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/AreaList.aspx?LMC=C&PV=AD008&mbn=' + strMain + '&mln=jeju_leftcon"><span> 리조트 </span></a>';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/AreaList.aspx?LMC=P&PV=AC007&mbn=' + strMain + '&mln=jeju_leftpension"><span> 펜션</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/rentcar/?mbn=' + strMain + '&mln=main_menujeju4" data-alert="true"><span>제주 실시간 렌터카</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?CateCD=038&mbn=' + strMain + '&mln=main_menujeju11#7246"><span>관광지 이용권</span></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <strong>스페셜 테마</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListHotel.aspx?PageGubun=032&CateCD=296&mbn=' + strMain + '&mln=main_menujeju3"><span>제주 추천 숙박</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/Search/ThemeListVoucher.aspx?CateCD=038&mbn=' + strMain + '&mln=main_menujeju12#7245"><span>레스토랑 식사권</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/housing/event/NewHousing.aspx?data-by=2&mbn=' + strMain + '&mln=main_menujeju10"><span>신규호텔의 발견</span></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <strong>패키지 예약</strong>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/jeju/d3/2719/?mbn=' + strMain + '&mln=main_menujeju17" data-alert="true"><span>2018 황금연휴</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/jeju/d3/2654/?mbn=' + strMain + '&mln=main_menujeju14" data-alert="true"><span>렌터카 무료제공 패키지</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/jeju/d3/678/?mbn=' + strMain + '&mln=main_menujeju8"><span>숙박+렌터카</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/jeju/d3/677/?mbn=' + strMain + '&mln=main_menujeju7"><span>항공+숙박</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/jeju/d3/676/?mbn=' + strMain + '&mln=main_menujeju6"><span>버스관광 패키지</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    //str += '                                <a href="' + HOST_DOMAIN + '/jeju/d3/7598/?mbn=' + strMain + '&mln=main_menujeju18" data-alert="true"><span>부산/대구/청주 출발</span></a>';
    str += '                            </p>';
    str += '                            <p class="normal">';
    str += '                                <a href="' + HOST_DOMAIN + '/package/d3/2801/?packagecd=2801&mbn=' + strMain + '&mln=main_menujeju16"><span>골프</span></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_28"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '                <dd aria-haspopup="true" onmouseover="hoverMenu(this)" onmouseleave="outMenu(this)" class="dTravel">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/domestic/?mbn=' + strMain + '&mln=tour_domestic" title="국내여행 바로가기" onfocus="focusMenu(this)">국내여행</a>';
    str += '                    </h4>';
    str += '                    <div class="sub-menu" aria-hidden="true">';
    str += '                        <h5>인터파크 국내여행</h5>';
    str += '                        <div class="menu">';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/domestic/weekend.aspx?cate=685&mbn=' + strMain + '&mln=main_menudomestic1" data-alert="true"><strong>금주 출발 확정</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/goods/2_2.aspx?cate=1473&mbn=' + strMain + '&mln=main_menudomestic2"><strong>추천여행</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/goods/2_2.aspx?cate=3139&mbn=' + strMain + '&mln=main_menudomestic3"><strong>당일여행</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/goods/2_2.aspx?cate=3140&mbn=' + strMain + '&mln=main_menudomestic4"><strong>숙박여행</strong></a>';
    str += '                            </p>';
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/goods/2_2.aspx?cate=963&mbn=' + strMain + '&mln=main_menudomestic5"><strong>섬여행</strong></a>';
    str += '                            </p>';
    str += '                        </div>';
    str += '                        <div class="menu">';    
    str += '                            <p class="emphasis">';
    str += '                                <a href="' + HOST_DOMAIN + '/category/domesticRentcar/main.aspx?mbn=tour&mln=main_menudomestic6"><strong>내륙 실시간 렌터카</strong></a>';
    str += '                            </p>';
    str += '					        <div id="subMenu_29"></div>';    
    str += '                        </div>';
    str += '                    </div>';
    str += '                </dd>';
    str += '            </dl>';
    str += '        </div>';
    str += '        <div class="gnb-box event">';
    //str += '            <h3 class="blind">인터파크 이벤트혜택존</h3>';
    str += '            <dl class="gnb-grid">';
    str += '                <dt aria-hidden="true">';
    str += '                    <h3>이벤트혜택존</h3>';
    str += '                </dt>';    
    str += '                <dd aria-haspopup="false" class="eBenefit">';
    str += '                    <h4>';
    str += '                        <a href="' + HOST_DOMAIN + '/event/?mbn=' + strMain + '&mln=tour_event" title="이벤트혜택존 바로가기" >이벤트혜택존</a>';
    str += '                    </h4>';
    str += '                </dd>';
    str += '            </dl>';
    str += '        </div>';
    str += '    </div>';
    str += '</div>';    

    //str += '<hr class="access" />';                                                                                                                                                                                                                   
    
    /* EGS 추가, 201705 스크립트 등록 */                                                                                                                                                                                                                
    str += '<script src="//www.interpark.com/static/js/egs/egs_common.js"></script>';                                                                                                                                                                   
    
    str = replaceSSLUrl(str);                                                                                                                                                                                                                           
    
    document.write(str);                                                                                                                                                                                                                                
}

_writeGNBArea();

/* ---------------------------------------------------------------------------------------------------------
// 배너관리 : touradmin
--------------------------------------------------------------------------------------------------------- */

function SetKeyWord() {
    var script = document.createElement('script');
    script.src = (isHTTPS ? 'https' : 'http') + '://tour.interpark.com/exporter/banner/TourMain.aspx?method=GetBanner_New';

    document.getElementsByTagName('head')[0].appendChild(script);
}

//메인 개편.. 수정
function SetBanners_New(obj) {
    /*
         1 : 상단띠배너(제외 메인페이지로 이동)
        ,2 : 통합검색창키워드
        ,3 : 헬로우배너
        ,4 : HOT 한줄문구
        ,20 : 서브메뉴_해외항공
        ,21 : 서브메뉴_해외호텔
        ,22 : 서브메뉴_해외자유여행
        ,23 : 서브메뉴_해외패키지
        ,24 : 서브메뉴_국내항공
        ,25 : 서브메뉴_국내호텔
        ,26 : 서브메뉴_국내콘도
        ,27 : 서브메뉴_국내펜션
        ,28 : 서브메뉴_국내제주도
        ,29 : 서브메뉴_국내내륙테마
        ,35 : 항공 호텔
        ,36 : 전문몰-테마여행
        ,38 : PC 게이트 소배너
        ,579 : GNB 플로팅배너
    */

    var str = "";

    var strPageTags = obj.strPageTags.split("/");

    //검색어
    var keywordInfo = getClass(obj, "2");

    var viewIndex = Math.floor(Math.random() * keywordInfo.arrkeyWord.length);

    // autocomplete 속성 off 고정 요청
    // 해당속성으로 제어 부분이있어 autofunction 속성 추가해서 대체
    //str += '            <input type="text" style="display: none;">';
    str += '            <input title="' + getReplaceStr(keywordInfo.arrkeyWord[viewIndex]) + '" value="' + getReplaceStr(keywordInfo.arrkeyWord[viewIndex]) + '" type="search" id="SearchGNBText" name="SearchGNBText"';
    str += '                   adkeyword="' + getReplaceStr(keywordInfo.arrkeyWord[viewIndex]) + '"';
    str += '                   adlink="' + getParamAddUrl(keywordInfo.arrLinkURL[viewIndex], strMain, 'top_searchbar', keywordInfo.arrSeq[viewIndex]) + '"';
    str += '                   autocorrect="off"';
    str += '                   autocapitalize="off"';
    str += '                   autocomplete="off"';
    str += '                   autocomplete="off"';
    //str += '                   onblur="searchBarModule.BoxHide();"';
    str += '                   onkeyup="searchBarModule.AutoComplete(this, event);" onfocus="searchBarModule.ClearAdKeyword(this, \'' + getReplaceStr(keywordInfo.arrkeyWord[viewIndex]) + '\');" />';

    //위 1030~1035 대체
    //str = '			<input title="' + getReplaceStr(keywordInfo.arrkeyWord[viewIndex]) + '" type="text" name="SearchGNBText" value="' + getReplaceStr(keywordInfo.arrkeyWord[viewIndex]) + '" id="SearchGNBText" autocomplete="off" autofunction="off" onkeyup="onCommonSearchAutoComplte(this, event);" onfocus="javascript:setFocus(this, event);" onblur="javascript:setBlur(this);"  />';
    str += '		<input type="hidden" name="SearchGNBUrl" value="' + getParamAddUrl(keywordInfo.arrLinkURL[viewIndex], strMain, 'top_searchbar', keywordInfo.arrSeq[viewIndex]) + '" id="SearchGNBUrl" style="display:none;" />';    

    //최근검색어관리 아이프레임
    var url = window.location.href.toLowerCase();
    if (url.indexOf("search-tour.interpark.com") > -1) {
        str += '<iframe style="width: 0; height: 0; border:0; border:none;" id="searchFrame" src="//tour.interpark.com/SearchTour/recentlyKeyword.html"></iframe>';
    } else {
        str += '<iframe style="width: 0; height: 0; border:0; border:none;" id="searchFrame" src="//search-tour.interpark.com/SearchTour/recentlyKeyword.html"></iframe>';
    }

    document.getElementById('box').innerHTML = replaceSSLUrl(str).replace('/&', '/?');

    searchAdStr = keywordInfo.arrkeyWord;
    for (var i = 0; i < keywordInfo.arrLinkURL.length; i++) {
        searchAdUrl.push(getParamAddUrl(keywordInfo.arrLinkURL[i], strMain, 'top_searchbar', keywordInfo.arrSeq[i]));
    }

    // 헬로우 배너
    keywordInfo = getClass(obj, "3");
    createHellowBannerLayer(keywordInfo, "GNBRollingBanner");

    // 플로팅 배너
    keywordInfo = getClass(obj, "579");
    createFloatingBannerLayer(keywordInfo, "GNBFloatingBanner");

    // 서브메뉴
    keywordInfo = getClass(obj, "20"); // 해외항공
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_20", "_cat_sub01", "10");

    keywordInfo = getClass(obj, "21"); //해외호텔
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_21", "_cat_sub02", "20");

    keywordInfo = getClass(obj, "22"); // 해외자유여행
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_22", "_cat_sub03", "30");

    keywordInfo = getClass(obj, "23"); // 해외패키지
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_23", "_cat_sub04", "40");

    keywordInfo = getClass(obj, "24"); // 국내항공
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_24", "_cat_sub08", "50");

    keywordInfo = getClass(obj, "25"); // 국내호텔
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_25", "_cat_sub09", "60");

    keywordInfo = getClass(obj, "26"); // 국내콘도
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_26", "_cat_sub10", "70");

    keywordInfo = getClass(obj, "27"); // 국내펜션
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_27", "_cat_sub11", "80");

    keywordInfo = getClass(obj, "28"); // 국내제주도
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_28", "_cat_sub12", "90");

    keywordInfo = getClass(obj, "29"); // 국내내륙테마
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_29", "_cat_sub13", "100");

    keywordInfo = getClass(obj, "35"); // 항공 호텔
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_35", "_cat_sub35", "110");

    keywordInfo = getClass(obj, "36"); // 전문몰
    CreateSubMenuKeywordLayer(keywordInfo, "subMenu_36", "_cat_sub14", "120");

    keywordInfo = getClass(obj, "38"); // 상단 게이트 소배너
    CreateGateBanner(keywordInfo, "topGateBanner");
}
//서브메뉴 키워드배너 로드
function CreateSubMenuKeywordLayer(keywordInfo, targetID, subName, mlnIndex) {
    try {

        var str = "";
        for (var i = 0; i < keywordInfo.arrSeq.length; i++) {
            if (keywordInfo.arrImageURL.length > 0) {
                if (keywordInfo.arrImageURL[i].length > 0) {
                    str += '<a href="' + keywordInfo.arrLinkURL[i] + '&mbn=' + strMain + '&mln=main_menuimg' + mlnIndex + '"';

                    if (subName == "_cat_sub13")
                        str += ' onblur="hide_glayer(\'_cat_sub13\')"';

                    str += ' target="' + (keywordInfo.arrNewWindow[i] == "Y" ? "_blank" : "_self") + '" class="banner">';
                    str += '<img src="http://tourimage.interpark.com/Sites/Tour/ByTemplate/098/' + keywordInfo.arrImageURL[i] + '" alt="' + keywordInfo.arrkeyWord[i] + '" />';
                    str += '</a>';
                }
            }
            else {
                document.getElementById("finalLi").onblur = hide_glayer('_cat_sub13');
            }
        }

        document.getElementById(targetID).innerHTML = replaceSSLHttps(replaceSSLUrl(str)).replace('/&', '/?');
        document.getElementById(targetID).setAttribute("display", "block");

    }
    catch (e) { }
}
//페이지태그 정보 로드
function getClass(obj, pageTag) {
    //    try{

    var keywordInfo = new keywordCls();

    keywordInfo.arrSeq = "";
    keywordInfo.arrkeyWord = "";
    keywordInfo.arrkeyWordA = "";
    keywordInfo.arrkeyWordB = "";
    keywordInfo.arrLinkURL = "";
    keywordInfo.arrImageURL = "";
    keywordInfo.arrNewWindow = "";

    if (obj["MainSeq_" + pageTag] != null && obj["MainSeq_" + pageTag] != "")
        keywordInfo.arrSeq = obj["MainSeq_" + pageTag].split("_/,");
    if (obj["MainKeyWord_" + pageTag] != null && obj["MainKeyWord_" + pageTag] != "")
        keywordInfo.arrkeyWord = obj["MainKeyWord_" + pageTag].split("_/,");
    if (obj["MainKeyWordA_" + pageTag] != null && obj["MainKeyWordA_" + pageTag] != "")
        keywordInfo.arrkeyWordA = obj["MainKeyWordA_" + pageTag].split("_/,");
    if (obj["MainKeyWordB_" + pageTag] != null && obj["MainKeyWordB_" + pageTag] != "")
        keywordInfo.arrkeyWordB = obj["MainKeyWordB_" + pageTag].split("_/,");
    if (obj["MainURL_" + pageTag] != null && obj["MainURL_" + pageTag] != "")
        keywordInfo.arrLinkURL = obj["MainURL_" + pageTag].split("_/,");
    if (obj["MainImageURL_" + pageTag] != null && obj["MainImageURL_" + pageTag] != "")
        keywordInfo.arrImageURL = obj["MainImageURL_" + pageTag].split("_/,");
    if (obj["MainNewWindow_" + pageTag] != null && obj["MainNewWindow_" + pageTag] != "")
        keywordInfo.arrNewWindow = obj["MainNewWindow_" + pageTag].split("_/,");

    return keywordInfo;

    //    }
    //    catch(e){}

}

//헬로우배너
function createHellowBannerLayer(keywordInfo, targetID) {
    try {   

        if (keywordInfo.arrSeq.length > 0) {
            var str = '<h2 class="blind">자동재생 롤링배너영역</h2>';
            str += '<button class="switch" title="일시정지">일시정지</button>';
            str += '<ul class="sld">';

            for (var x = 0; x < keywordInfo.arrSeq.length; x++) {
                str += '<li class="item">';
                var linkurl = keywordInfo.arrLinkURL[x];
                var hash = '';

                if (linkurl.indexOf('#') > -1)
                {
                    try {
                        hash = linkurl.split('#')[1];
                    } catch (e) {}                    
                }

                if (hash == "talkFixed" && typeof ExcuteTalkEnterModuleFiexed == 'function') {
                    str += '    <a href="javascript:ExcuteTalkEnterModuleFiexed();" target="' + (keywordInfo.arrNewWindow[x] == "Y" ? "_blank" : "_self") + '" >';
                }
                else {
                    str += '    <a href="' + getParamAddUrl(keywordInfo.arrLinkURL[x], strMain, 'tour_hello_0', x + 1) + '" target="' + (keywordInfo.arrNewWindow[x] == "Y" ? "_blank" : "_self") + '" >';
                }
                
                str += '        <img id="rollGNBImg" alt="' + getReplaceStr(keywordInfo.arrkeyWord[x]) + '" src="http://tourimage.interpark.com/Sites/Tour/ByTemplate/098/' + keywordInfo.arrImageURL[x] + '" />';
                str += '    </a>';
                str += '</li>';
            }

            str += '</ul>';
        }
        
        document.getElementById("GNBRollingBanner").innerHTML = replaceSSLHttps(replaceSSLUrl(str)).replace('/&', '/?');

        var headerSlide = new uiSlider({
            time: 3000,
            random: false,
            btn: true,
            focus: true,
            hover: true,
            slideWrap: document.querySelector('.banner-box')
        });
    }
    catch (e) { }
}

// 플로팅 배너
function createFloatingBannerLayer(keywordinfo, targetID) {
   
    if (keywordinfo.arrSeq.length > 0) {
        var html = '';        

        if (keywordinfo.arrLinkURL != '' && keywordinfo.arrLinkURL.length > 0)
            html += '           <a href="' + (keywordinfo.arrLinkURL[0] == "" ? "#" : AddParam(keywordinfo.arrLinkURL[0], 'mbn=tour_main&mln=header#TOUR')) + '" target="' + (keywordinfo.arrNewWindow[0] == "Y" ? "_blank" : "_self") + '">';

        html += '               <img src="http://tourimage.interpark.com/Sites/Tour/ByTemplate/030/' + keywordinfo.arrImageURL[0] + '" alt="' + keywordinfo.arrkeyWord[0] + '" onerror="this.style.display=\'none\';" />';
        
        if (keywordinfo.arrLinkURL != '' && keywordinfo.arrLinkURL.length > 0)
            html += '           </a>';

        document.getElementById(targetID).innerHTML = replaceSSLHttps(replaceSSLUrl(html)).replace('/&', '/?');
    }

}

// 상단 게이트 소배너
function CreateGateBanner(keywordinfo, targetid)
{
    if (keywordinfo.arrSeq.length > 0)
    {
        var html = '';
        html += '   <ul>';
        html += '	    <li >';

        if (keywordinfo.arrLinkURL.length > 0)
            html += '           <a href="' + (keywordinfo.arrLinkURL[0] == "" ? "#" : AddParam(keywordinfo.arrLinkURL[0], 'mbn=tour_main&mln=header#TOUR')) + '" target="' + (keywordinfo.arrNewWindow[0] == "Y" ? "_blank" : "_self") + '">';

        html += '               <img src="http://tourimage.interpark.com/Sites/Tour/ByTemplate/098/' + keywordinfo.arrImageURL[0] + '" alt="' + keywordinfo.arrkeyWord[0] + '" onerror="this.style.display=\'none\';" />';

        if (keywordinfo.arrLinkURL.length > 0)
            html += '           </a>';

        html += '       </li>';
        html += '   </ul>';

        document.getElementById(targetid).innerHTML = replaceSSLHttps(replaceSSLUrl(html)).replace('/&', '/?');
    }
}

/* ---------------------------------------------------------------------------------------------------------
// 통합검색
--------------------------------------------------------------------------------------------------------- */

if (typeof document.body.onclick != "undefined") {

    document.body.onclick = function (evt) {
        try {
            var targetHtml = evt ? evt.target.innerHTML : window.event.srcElement.innerHTML;

            if (targetHtml != ""
                && (document.getElementById("AutoComplete").style.display == "block" ||
                    document.getElementById("SearchWord").style.display == "block"
                )
                //&& document.getElementById("SearchGNBText").getAttribute("autocomplete") == "on"
                && document.getElementById("SearchGNBText").getAttribute("autofunction") == "on"
                && document.getElementById("AutoComplete").innerHTML.indexOf(targetHtml) <= 0
                && document.getElementById("SearchGNBFrom").innerHTML.indexOf(targetHtml) <= 0) {
                CommonSearchHideLayer();
            }
        } catch (e) { }
    }
}

function setFocus(obj, e) {

    //if (!(obj.getAttribute("autocomplete") == "off" && obj.value != "" && (lastKeyword == obj.value || typeof HEAD_AREA_QUERY === "string"))) {
    if (!(obj.getAttribute("autofunction") == "off" && obj.value != "" && (lastKeyword == obj.value || typeof HEAD_AREA_QUERY === "string"))) {
        obj.value = '';
        searchTxtStats = true;
    }

    if (navigator.userAgent.toLowerCase().indexOf("firefox") > -1) {
        eventKeyUpInterval = setInterval(function () {
            if (lastEventKeyUpValue != document.getElementById("SearchGNBText").value) {
                CommonFireEvent(document.getElementById("SearchGNBText"), "keyup");
            }
            lastEventKeyUpValue = document.getElementById("SearchGNBText").value;
        }, 100);
    }

    var searchWordObject = document.getElementById("SearchWord");
    var autoCompleteObject = document.getElementById("AutoComplete");

    if (obj.value == "" && searchWordObject.style.display == "none" && autoCompleteObject.style.display == "none") {
        try {
            var scriptElement = document.createElement("script");
            scriptElement.type = "text/javascript";
            scriptElement.src = replaceSSLHttps("http://itis01.interpark.com/Get.aspx?callback=autoCompleteSearchHistory");

            document.getElementsByTagName("head")[0].appendChild(scriptElement);
        } catch (e) { }
    }
}

function SearchGNBArea(type) {
    var url = '';
    var goUrl = '' + HOST_DOMAIN + '/search/search.aspx';
    var searchStr = document.getElementById("SearchGNBText").value;
    var searchUrl = document.getElementById("SearchGNBUrl").value;
    var searchYN = 'N';

    if (searchStr == "") {
        alert("검색어를 입력하세요.");
        document.getElementById("SearchGNBText").focus();
    }
    else {
        if (typeof HEAD_AREA_QUERY === "string") {
            if (HEAD_AREA_QUERY == searchStr) return;
        }

        document.getElementById("SearchGNBText").blur();

        for (var i = 0; i < searchAdStr.length; i++) {
            if (searchStr == getReplaceStr(searchAdStr[i])) {
                url = searchAdUrl[i];
                searchYN = 'Y';
                break;
            }
        }

        if (searchYN == 'N') {
            url = goUrl + '?q=' + encodeURIComponent(searchStr);
            if (typeof type != "undefined" && type == "Y") {
                url = url + "&referrer=autocomlete";
            }
        }

        // EGS 추가, 201705 BTN_SEARCH / AUTOCOMPLETE 
        try {
            if (searchYN == "N" && (typeof type != "undefined" && type == "Y")) {
                EGS_Autocomplete("", "");
            }
            else {
                EGS_BtnSearch();
            }
        } catch (ex) { }

        document.location = url;

    }
}

function onCommonSearchKeyboardHandler(keyCode, e) {
    if (document.getElementById("AutoComplete").style.display == "block"
        //&& document.getElementById("SearchGNBText").getAttribute("autocomplete") == "on"
        && document.getElementById("SearchGNBText").getAttribute("autofunction") == "on"
        && (keyCode == 38 || keyCode == 40 || keyCode == 13 || keyCode == 27)) {
        if (keyCode == 38 && !isFirefox) {
            if (isSelectAutoCompleteResult == 0 || isSelectAutoCompleteResult == 1) {
                document.getElementById("SearchGNBText").value = "";
                CommonSearchHideLayer();
                e.returnValue = false;
                return;
            }
            for (var i = 0; i < onSelectAutoCompleteResult.length; i++) onSelectAutoCompleteResult[i].className = "off";
            document.getElementById("SearchGNBText").value = onSelectAutoCompleteResult[(isSelectAutoCompleteResult - 1)].getAttribute("data");
            CommonFireEvent(onSelectAutoCompleteResult[isSelectAutoCompleteResult - 1], "mouseover");
            document.getElementById("SearchGNBText").focus();
        }
        else if (keyCode == 40 && !isFirefox && onSelectAutoCompleteResult.length - 1 > isSelectAutoCompleteResult) {
            if (onSelectAutoCompleteResult[onSelectAutoCompleteResult.length - 1].getAttribute("class") == "on") { e.returnValue = false; return; }
            for (var i = 0; i < onSelectAutoCompleteResult.length; i++) onSelectAutoCompleteResult[i].className = "off";
            document.getElementById("SearchGNBText").value = onSelectAutoCompleteResult[(isSelectAutoCompleteResult + 1)].getAttribute("data");
            CommonFireEvent(onSelectAutoCompleteResult[(isSelectAutoCompleteResult + 1)], "mouseover");
            document.getElementById("SearchGNBText").focus();
        }
        else if (keyCode == 13) {
            if (isSelectAutoCompleteResult == 0) SearchGNBArea("N");
            else {
                var tObject = document.getElementById("AutoCompleteGoURL");
                if (tObject && tObject.getAttribute("type") == "goods") location.href = tObject.href;
                else SearchGNBArea("Y");
            }
            CommonSearchHideLayer();
        }
        else if (keyCode == 27) CommonSearchHideLayer();
    }
    else {
        if (keyCode == 13) {
            SearchGNBArea("N");
        }
        else if ((keyCode == 8 || keyCode == 48) && document.getElementById("SearchGNBText").value == "" && document.getElementById("AutoComplete").style.display == "none") {
            try {
                var scriptElement = document.createElement("script");
                scriptElement.type = "text/javascript";
                scriptElement.src = replaceSSLHttps("http://itis01.interpark.com/Get.aspx?callback=autoCompleteSearchHistory");

                document.getElementsByTagName("head")[0].appendChild(scriptElement);
            } catch (e) { }
        }
    }
}

function onCommonSearchAutoComplte(obj, e) {
    //기존 Form 방식의 핸들러를 오직 이곳으로만 처리함.(키보드 처리)
    var keyCode = typeof e === "undefined" ? 0 : (typeof e.which != "undefined" ? e.which : e.keyCode);
    if (keyCode == 38 || keyCode == 40 || keyCode == 13 || keyCode == 27 || keyCode == 8 || keyCode == 46) {
        onCommonSearchKeyboardHandler(keyCode, typeof e != "undefined" ? e : window.event);
        return;
    }
    else if (keyCode == 39 || keyCode == 37) {
        return;
    }

    //자동완성 기능 끄기로 닫은경우 막기
    if (isDisableAutoComplete) return;

    if (isAutoComplete) return;
    isAutoComplete = true;
    //document.getElementById("SearchGNBText").setAttribute("autocomplete", "on");
    document.getElementById("SearchGNBText").setAttribute("autofunction", "on");

    var searchKey = CommonSearchTrim(obj.value);
    var autoCompleteObject = document.getElementById("AutoComplete");
    autoCompleteObject.innerHTML = "";
    autoCompleteObject.style.display = "none";
    if (getStringBytes(CommonSearchTrim(searchKey)) <= 0 || !CommonSearchLastCharacter(searchKey)) {
        isAutoComplete = false;
        return;
    }

    lastKeyword = searchKey;

    var scriptElement = document.createElement("script");
    scriptElement.type = "text/javascript";
    scriptElement.src = replaceSSLHttps("http://toursearch.interpark.com/WS/Suggest.aspx?callback=onCommonSearchAutoComplteCallback&query=") + encodeURIComponent(searchKey);

    document.getElementsByTagName("head")[0].appendChild(scriptElement);
}

function onCommonSearchAutoComplteCallback(queryKey, GData, CData, korOrEng) {
    var autoCompleteObject = document.getElementById("AutoComplete");
    onSelectAutoCompleteResult = new Array();
    onSelectAutoCompleteResult.push(document.createElement("li"));

    if (parseInt(GData.docs.ret.totalhits, 10) > 0 || parseInt(CData.docs.ret.totalhits, 10) > 0) {
        var h1Element = document.createElement("h1");
        h1Element.innerHTML = "자동완성";
        autoCompleteObject.appendChild(h1Element);

        var divListGElement = document.createElement("div")
        divListGElement.className = "list-module01";

        var divListDElement = document.createElement("div");
        divListDElement.className = "view-module02";

        var fistRightContent = document.createElement("div");
        fistRightContent.setAttribute("id", "AutoCompleteRightContent");

        var GCount = 0;
        var ulGListElement = document.createElement("ul");
        ulGListElement.className = "data-list";
        CommonSearchEach(GData.docs.doc, function (i, doc) {
            var liElement = document.createElement("li");
            liElement.style.cursor = "pointer";

            if (korOrEng == "True") {
                liElement.setAttribute("data", doc.korgoodsname);
            } else {
                liElement.setAttribute("data", doc.enggoodsname);
            }            

            var aElement = document.createElement("a");

            if (korOrEng == "True") {
                aElement.setAttribute("data", doc.korgoodsname);
            } else {
                aElement.setAttribute("data", doc.enggoodsname);
            }            

            aElement.setAttribute("href", "javascript:;");
            //이벤트 바인딩
            liElement.onclick = function () {

                if (korOrEng == "True") {
                    document.getElementById("SearchGNBText").value = doc.korgoodsname;
                } else {
                    document.getElementById("SearchGNBText").value = doc.enggoodsname;
                }                

                SearchGNBArea("Y");
            }
            liElement.onmouseover = function () {
                var obj = document.getElementById("AutoCompleteRightContent");
                obj.innerHTML = "";
                obj.appendChild(setRightContentBind(queryKey, doc));
                for (var j = 0; j < onSelectAutoCompleteResult.length; j++) onSelectAutoCompleteResult[j].className = "off";
                this.className = "on";
                isSelectAutoCompleteResult = i + 1;
            }
            onSelectAutoCompleteResult.push(liElement);
            //첫번째 데이타로 우측 상세 바인딩
            if (i == 0) {
                fistRightContent.appendChild(setRightContentBind(queryKey, doc));
            }

            var AddRegionNames = '';

            if (doc.region1 == doc.region2) {
                AddRegionNames = doc.region1;
            } else {
                AddRegionNames = ((doc.region2 != '') ? doc.region2 : '') + ((doc.region1 != '') ? "," + doc.region1 : '');
            }

            if (korOrEng == "True") {
                aElement.innerHTML += setAutoCompleteHighlight(queryKey, doc.korgoodsname) + "<span style='color:#BDBDBD;font-size:11px;padding-left:10px'>" + AddRegionNames + "</span>";
            } else {
                aElement.innerHTML += setAutoCompleteHighlight(queryKey, doc.enggoodsname) + "<span style='color:#BDBDBD;font-size:11px;padding-left:10px'>" + AddRegionNames + "</span>";
            }

            liElement.appendChild(aElement);
            ulGListElement.appendChild(liElement);

            GCount = GCount + 1;
        }, function () {
            if (GCount > 0) divListGElement.appendChild(ulGListElement);
        });

        var CCount = 0;
        var ulCListElement = document.createElement("ul");
        ulCListElement.className = "data-list add01";
        CommonSearchEach(CData.docs.doc, function (i, doc) {
            var hrefURL = doc.depth3text == "" ? doc.depth2url : doc.depth3url;
            hrefURL = hrefURL + (hrefURL.indexOf('?') > -1 ? "&" : "?") + "mbn=tour&mln=tsearch_total1"
            var liElement = document.createElement("li");
            liElement.style.cursor = "pointer";
            liElement.setAttribute("data", doc.depth3text == "" ? doc.depth2text : doc.depth3text);
            var aElement = document.createElement("a");
            aElement.setAttribute("href", hrefURL);
            aElement.setAttribute("target", "_self");

            /* EGS 추가, 201705 AUTOCOMPLETE 카테고리검색 */
            aElement.setAttribute("onclick", "return EGS_Autocomplete(\'" + "" + "\', \'" + "" + "\');");

            //이벤트 바인딩
            liElement.onclick = function () {
                location.href = hrefURL;
            }
            liElement.onmouseover = function () {
                var obj = document.getElementById("AutoCompleteRightContent");
                obj.innerHTML = "";
                obj.appendChild(setRightContentBind(queryKey, doc));
                for (var j = 0; j < onSelectAutoCompleteResult.length; j++) onSelectAutoCompleteResult[j].className = "off";
                this.className = "on";
                isSelectAutoCompleteResult = GCount + i + 1;
            }
            onSelectAutoCompleteResult.push(liElement);
            aElement.innerHTML = doc.navitext + "<span> > </span>";
            aElement.innerHTML += doc.depth3text == "" ? setAutoCompleteHighlight(queryKey, doc.depth2text) : setAutoCompleteHighlight(queryKey, doc.depth3text);
            liElement.appendChild(aElement);
            ulCListElement.appendChild(liElement);
            CCount = CCount + 1;

        }, function () {
            if (CCount > 0) {
                var h2Element = document.createElement("h2");
                h2Element.className = "tit";
                h2Element.innerHTML = "카테고리검색";
                divListGElement.appendChild(h2Element);
                divListGElement.appendChild(ulCListElement);
            }
        });

        //우측 상세 영역 바인딩
        divListDElement.appendChild(fistRightContent);
        {
            var spanElement = document.createElement("span");
            spanElement.className = "fun-off";
            var arrElement = new Array();
            arrElement.push('<input type="checkbox" id="AutoCompleteOnOff" class="input-check" onmouseover="document.getElementById(\'AutoCompleteToolTip\').style.display = \'block\';" onmouseout="document.getElementById(\'AutoCompleteToolTip\').style.display = \'none\';" onclick="offAutoComplete();" />');
            arrElement.push('<label for="AutoCompleteOnOff" onmouseover="document.getElementById(\'AutoCompleteToolTip\').style.display = \'block\';" onmouseout="document.getElementById(\'AutoCompleteToolTip\').style.display = \'none\';">자동완성 기능 끄기</label>');
            arrElement.push('<img src="' + replaceSSLUrl("http://openimage.interpark.com/tourpark/tour_ui/common/header/autocomplete/help_tooltip.gif") + '" id="AutoCompleteToolTip" alt="기능을 다시 사용하실 때는 상단쪽 검색영역을 클릭하세요." class="tool-tip"/>');
            spanElement.innerHTML = arrElement.join('');
            divListDElement.appendChild(spanElement);
        }

        autoCompleteObject.appendChild(divListGElement);
        autoCompleteObject.appendChild(divListDElement);
        autoCompleteObject.style.display = "block";        

        var searchWordObject = document.getElementById("SearchWord");
        if (searchWordObject.style.display != "none" || searchWordObject.innerHTML != "") {
            searchWordObject.style.display = "none";
            searchWordObject.innerHTML = "";
        }
    }
    isAutoComplete = false;
}

function autoCompleteSearchHistory(result, favoriteData) {
    var splResult = result.split('||');

    //document.getElementById("SearchGNBText").setAttribute("autocomplete", "on");
    document.getElementById("SearchGNBText").setAttribute("autofunction", "on");
    var searchWordObject = document.getElementById("SearchWord");
    searchWordObject.innerHTML = "";

    {
        var h1Element = document.createElement("h1");
        h1Element.innerText = "통합검색";

        var divElement = document.createElement("div");
        divElement.className = "world-module01";

        var h2Element = document.createElement("h2");
        h2Element.innerText = "최근검색어";
        h2Element.className = "tit";

        var ulElement = document.createElement("ul");
        ulElement.className = "world-list1";

        if (splResult.length > 0) {
            var j = splResult.length - 1;

            for (var i = 0; i < splResult.length; i++) {

                if (splResult[j] != "") {

                    var liElement = document.createElement("li");

                    var aElement = document.createElement("a");
                    aElement.href = "javascript:;";
                    aElement.setAttribute("data", splResult[j]);
                    aElement.innerText = splResult[j];

                    aElement.onclick = function (evt) {
                        document.getElementById("SearchGNBText").value = this.getAttribute("data");
                        SearchGNBArea("Y");
                    };

                    var aElementDelete = document.createElement("a");
                    aElementDelete.href = "javascript:;";
                    aElementDelete.setAttribute("data", splResult[j]);
                    aElementDelete.className = "del";
                    aElementDelete.innerText = "삭제";

                    aElementDelete.onclick = function (evt) {
                        try {
                            var scriptElement = document.createElement("script");
                            scriptElement.type = "text/javascript";
                            scriptElement.src = replaceSSLHttps("http://itis01.interpark.com/?query=" + encodeURIComponent(this.getAttribute("data")) + "&type=del&callback=autoCompleteSearchHistoryDelete");

                            document.getElementsByTagName("head")[0].appendChild(scriptElement);
                        } catch (e) { }
                    };

                    liElement.appendChild(aElement);
                    liElement.appendChild(aElementDelete);
                    ulElement.appendChild(liElement);
                }
                j--;
            }
        }

        var aElement = document.createElement("a");
        aElement.className = "total-del";
        aElement.href = "javascript:;";
        aElement.setAttribute("shape", "");
        aElement.innerText = "전체삭제";
        aElement.onclick = function (evt) {
            try {
                var scriptElement = document.createElement("script");
                scriptElement.type = "text/javascript";
                scriptElement.src = replaceSSLHttps("http://itis01.interpark.com/?query=&type=totaldel&callback=autoCompleteSearchHistoryDelete");

                document.getElementsByTagName("head")[0].appendChild(scriptElement);
            } catch (e) { }
        };

        var pElement = document.createElement("p");
        pElement.className = "info-words";
        pElement.innerText = "최근 검색한 결과가 없습니다.";

        divElement.appendChild(h2Element);

        if (result == "") {
            divElement.appendChild(pElement);
        } else {
            divElement.appendChild(ulElement);
            divElement.appendChild(aElement);
        }

        searchWordObject.appendChild(h1Element);
        searchWordObject.appendChild(divElement);
    }

    {
        var divElement = document.createElement("div");
        divElement.className = "world-module02";

        var h2Element = document.createElement("h2");
        h2Element.innerText = "인기검색어";
        h2Element.className = "tit";

        var ulElement = document.createElement("ul");
        ulElement.className = "world-list2";

        for (var i = 0; i < favoriteData.Table.length; i++) {
            var liElement = document.createElement("li");            
            if (i == 0 || i == 1 || i == 2) {
                liElement.className = "selected";
            }

            var aElement = document.createElement("a");
            aElement.href = "javascript:;";
            aElement.setAttribute("data", favoriteData.Table[i].Keyword);

            var emElement = document.createElement("em");
            emElement.className = "num";
            emElement.innerText = (i + 1).toString();

            var spanElement = document.createElement("span");
            spanElement.className = "tit";
            spanElement.innerText = favoriteData.Table[i].Keyword;

            aElement.appendChild(emElement);
            aElement.appendChild(spanElement);


            aElement.onclick = function (evt) {
                document.getElementById("SearchGNBText").value = this.getAttribute("data");
                SearchGNBArea("Y");
            };
            liElement.appendChild(aElement);
            ulElement.appendChild(liElement);
        }

        divElement.appendChild(h2Element);
        divElement.appendChild(ulElement);
        searchWordObject.appendChild(divElement);
    }

    searchWordObject.style.display = "block";    
}

function autoCompleteSearchHistoryDelete() {
    try {
        var scriptElement = document.createElement("script");
        scriptElement.type = "text/javascript";
        scriptElement.src = replaceSSLHttps("http://itis01.interpark.com/Get.aspx?callback=autoCompleteSearchHistory");

        document.getElementsByTagName("head")[0].appendChild(scriptElement);
    } catch (e) { }
}

function CommonFireEvent(el, evt) {
    if (document.createEventObject) { var evtEl = document.createEventObject(); return el.fireEvent('on' + evt, evtEl); }
    else { var evtEl = document.createEvent("HTMLEvents"); evtEl.initEvent(evt, true, true); return !el.dispatchEvent(evtEl) };
}

function CommonSearchHideLayer() {
    document.getElementById("AutoComplete").style.display = "none";
    document.getElementById("AutoComplete").innerHTML = "";
    document.getElementById("SearchWord").style.display = "none";
    //document.getElementById("SearchGNBText").setAttribute("autocomplete", "off");
    document.getElementById("SearchGNBText").setAttribute("autofunction", "off");
    isSelectAutoCompleteResult = 0;
}

function onAutoComplete() {
    isDisableAutoComplete = false;
    if (document.getElementById("SearchGNBText").value != "") {
        CommonFireEvent(document.getElementById("SearchGNBText"), "keyup");
    } else if (document.getElementById("AutoComplete").style.display == "none") {
        try {
            var scriptElement = document.createElement("script");
            scriptElement.type = "text/javascript";
            scriptElement.src = replaceSSLHttps("http://itis01.interpark.com/Get.aspx?callback=autoCompleteSearchHistory");

            document.getElementsByTagName("head")[0].appendChild(scriptElement);
        } catch (e) { }
    }
}

function offAutoComplete() {
    isDisableAutoComplete = true;
    CommonSearchHideLayer();
}

function toggleAutoComplete() {
    if (isDisableAutoComplete) onAutoComplete();
    else offAutoComplete();
}

function setBlur(obj) {    
    if (obj.value == '') {
        searchTxtStats = false;
        searchStats = false
    }
    clearInterval(eventKeyUpInterval);
}

function setRightContentBind(queryKey, data) {

    /* EGS 추가, 201705 분류번호 */
    var egsCate = typeof data.categorycode2 === "undefined" ? "" : data.categorycode2;
    /* EGS 추가, 201705 상품번호 */
    var egsItem = typeof data.goodscode === "undefined" ? "" : data.goodscode;

    var divElement = document.createElement("div");
    {
        var ulElement = document.createElement("ul");
        ulElement.className = "pro-list";
        {
            var liElement = document.createElement("li");
            liElement.className = "on";
            //카테고리검색 영역 :: START
            if (typeof data.categorycode1 === "undefined" && data.navitext) {
                var spanElement = document.createElement("span");
                spanElement.className = "on con";
                var arrElement = new Array();
                arrElement.push('검색된 카테고리를');
                arrElement.push('<br/>');
                arrElement.push('선택하시면');
                arrElement.push('<br/>');
                /* EGS 추가, 201705 EGS_Autocomplete 추가 */
                arrElement.push('<a href="' + (data.depth3text == "" ? data.depth2url : data.depth3url) + '" onclick="return EGS_Autocomplete(\'' + egsCate + '\', \'' + egsItem + '\');">');
                arrElement.push('<strong>' + data.navitext + '<span> > </span>' + (data.depth3text == "" ? data.depth2text : data.depth3text) + '</strong>');
                arrElement.push('</a>');
                arrElement.push('<br/>');
                arrElement.push('상품리스트로 바로');
                arrElement.push('<br/>');
                arrElement.push('이동합니다.');
                spanElement.innerHTML = arrElement.join('');
                liElement.appendChild(spanElement);
            }
                //카테고리검색 영역 :: END
                //해외호텔, 숙박상품, 여행키워드 전용 영역 :: START
            else {
                {
                    var strongElement = document.createElement("strong");
                    strongElement.className = "tit02";
                    var title01Image = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour_ui/common/header/autocomplete/tit_goods_" + data.categorycode1 + ".gif");
                    var title02Image = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour_ui/common/header/autocomplete/tit_recom_pro.gif");
                    var goodsImage = (data.categorycode1 == "O" || data.categorycode1 == "R" || data.categorycode1 == "T") && isHTTPS ? "https://sslimage.interpark.com/tourpark/tour/search/security_img.gif" : replaceSSLHttps(data.imageurl);
                    var noGoodsImage = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour_ui/common/header/autocomplete/no_img.gif");
                    strongElement.innerHTML = '<img src="' + title01Image + '" alt="' + data.category1 + '" />' + (data.categorycode1 == "R" || data.categorycode1 == "T" ? '<img src="' + title02Image + '" alt="추천상품" />' : '');
                    liElement.appendChild(strongElement);

                    var spanElement = document.createElement("span");
                    spanElement.className = "photo";
                    /* EGS 추가, 201705 EGS_Autocomplete 추가 */
                    spanElement.innerHTML = '<a href="' + data.goodsurl + '" target="_self" onclick="return EGS_Autocomplete(\'' + egsCate + '\', \'' + egsItem + '\');"><img src="' + goodsImage + '" onError="this.src=replaceSSLUrl(\'http://openimage.interpark.com/tourpark/tour/search/no_img.gif\');" alt="' + data.synonym + '"/></a>';
                    liElement.appendChild(spanElement);
                }
                {
                    var spanElement = document.createElement("span");
                    spanElement.className = "sub-tit";
                    var dGoodsName = getStringBytes(data.synonym) > 30 ? getSubstringBytes(data.synonym, 29) + "..." : data.synonym;
                    /* EGS 추가, 201705 EGS_Autocomplete 추가 */
                    spanElement.innerHTML = '<a href="' + data.goodsurl + '" title="' + data.synonym + '" onclick="return EGS_Autocomplete(\'' + egsCate + '\', \'' + egsItem + '\');">' + dGoodsName + '</a>';
                    liElement.appendChild(spanElement);
                }
                {
                    var sulElement = document.createElement("ul");
                    var regionName = data.categorycode1 == "R" || data.categorycode1 == "T" ? data.region2 : data.region1 + " " + data.region2;
                    var dRegionName = getStringBytes(regionName) > 18 ? getSubstringBytes(regionName, 16) + "..." : regionName;
                    var ipointImage = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour/common/icon/icon_ipoint01.gif");

                    var arrElement = new Array();
                    if (dRegionName != "") arrElement.push('<li title="' + regionName + '">지역 : ' + dRegionName + '</li>');
                    //해외호텔상품 전용 영역 :: START
                    if (data.categorycode1 == "O") arrElement.push('<li>등급 : <em>' + data.goodsgrade + ' 성급</em></li>');
                    //해외호텔상품 전용 영역 :: END
                    arrElement.push('<li>가격 : ');
                    arrElement.push('<span class="won"><strong>' + formattedNumber(data.price) + '</strong>원~</span>');
                    //arrElement.push('<span class="ipoint"><img src="' + ipointImage + '" alt="아이포인트"><strong>' + formattedNumber(parseInt(data.price, 10) * (parseInt(data.porintrate, 10) / 100)) + '</strong>적립</span>');
                    arrElement.push('</li>');
                    sulElement.innerHTML = arrElement.join('');
                    liElement.appendChild(sulElement);
                }
                //해외호텔, 숙박상품, 여행키워드 전용 영역 :: END
            }
            ulElement.appendChild(liElement);
        }
        divElement.appendChild(ulElement);
    }
    {
        var spanElement = document.createElement("span");
        spanElement.className = "btn-area";
        if (typeof data.categorycode1 === "undefined" && data.navitext) spanElement.style.display = "none";

        var listType = typeof data.categorycode1 === "undefined" && data.navitext ? "goods" : "search";
        var hrefURL = typeof data.categorycode1 === "undefined" && data.navitext ? (data.depth3text == "" ? data.depth2url : data.depth3url) : data.goodsurl;
        hrefURL = hrefURL + (hrefURL.indexOf('?') > -1 ? "&" : "?") + "mbn=" + strMain + "&mln=tsearch_total1"
        var btnImage = replaceSSLUrl("http://openimage.interpark.com/tourpark/tour_ui/common/header/autocomplete/btn_pro_view01.gif");
        /* EGS 추가, 201705 EGS_Autocomplete 추가 */
        spanElement.innerHTML = '<a id="AutoCompleteGoURL" type="' + listType + '" href="' + hrefURL + '" target="_self" onclick="return EGS_Autocomplete(\'' + egsCate + '\', \'' + egsItem + '\');"><img src="' + btnImage + '" alt="상품상세보기"/></a>';
        divElement.appendChild(spanElement);
    }
    return divElement;
}

function setAutoCompleteHighlight(searchKey, resultNm) {
    return resultNm.split(searchKey).join("<strong>" + searchKey + "</strong>");
}

function getStringBytes(value) {
    var str = value;
    var nLen = 0;
    for (var i = 0; i < str.length; i++) { nLen += (str.charCodeAt(i) > 128) ? 2 : 1; }
    return nLen;
}

function getSubstringBytes(value, bytes) {
    var rtnValue = "";
    var j = 0;
    for (var i = 0; j < bytes; i++) {
        rtnValue += value.charAt(i);
        if (value.charCodeAt(i) > 128) j = j + 2;
        else j = j + 1;
    }
    return rtnValue;
}
/* jQuery.each IE6 Bug로 인해 별도 Each 생성 */
function CommonSearchEach(object, callback, complete) {
    var name;
    var i = 0;
    var length = undefined;
    try {
        length = object.length;
    } catch (e) { }

    var isObj = length === undefined || typeof object === "function";

    if (isObj) {
        for (name in object) {
            if (callback.call(object[name], name, object[name]) === false) {
                break;
            }
        }
    } else {
        for (; i < length;) {
            if (callback.call(object[i], i, object[i++]) === false) {
                break;
            }
        }
    }

    if (typeof complete === "function") {
        complete.call();
    }

    return object;
}

function CommonSearchTrim(str) {
    return str.replace(/^\s\s*/, "").replace(/\s\s*$/, "");
}

function CommonSearchLastCharacter(searchKey) {
    var validKey = CommonSearchTrim(searchKey);
    var validKeyLength = validKey.length - 1;
    var returnValue = false;
    var RegExp = /[^A-z|0-9|\ |\r\n]/g;

    if (typeof validKey === "undefined" || validKey == '') return false;

    if ((validKey.charCodeAt(validKeyLength) >= 44032 && validKey.charCodeAt(validKeyLength) <= 55203)
        || (validKey.charCodeAt(validKeyLength) >= 48 && validKey.charCodeAt(validKeyLength) <= 57)
        || (validKey.charCodeAt(validKeyLength) >= 65 && validKey.charCodeAt(validKeyLength) <= 90)
        || (validKey.charCodeAt(validKeyLength) >= 97 && validKey.charCodeAt(validKeyLength) <= 122)) {
        returnValue = true;
    }
    return returnValue;
}

function formattedNumber(n) {
    n = parseInt(n, 10).toString();
    var reg = /(^[+-]?\d+)(\d{3})/;   // 정규식
    n += '';                          // 숫자를 문자열로 변환
    while (reg.test(n)) {
        n = n.replace(reg, '$1' + ',' + '$2');
    }
    return n;
}

/* ---------------------------------------------------------------------------------------------------------
// Common Script 
--------------------------------------------------------------------------------------------------------- */

function getCookie(name) {
    var nameOfCookie = name + "=";
    var x = 0;
    while (x <= document.cookie.length) {
        var y = (x + nameOfCookie.length);
        if (document.cookie.substring(x, y) == nameOfCookie) {
            if ((endOfCookie = document.cookie.indexOf(";", y)) == -1)
                endOfCookie = document.cookie.length;
            return unescape(document.cookie.substring(y, endOfCookie));
        }
        x = document.cookie.indexOf(" ", x) + 1;
        if (x == 0)
            break;
    }
    return "";
}

function getHrefParams(name, def) {
    var q = document.location.search;
    var i = q.indexOf(name + '=');
    if (i == -1) {
        return def;
    }

    var r = q.substr(i + name.length + 1, q.length - i - name.length - 1);
    i = r.indexOf('&');

    if (i != -1) {
        r = r.substr(0, i);
    }

    return r.replace(/\+/g, ' ');
}

function GetBasePath(url) {
    var r = ('' + url).match(/^(https?:)?\/\/[^/]+/i);
    var returnValue = r ? r[0] : '';
    returnValue = returnValue.replace('https', 'http');

    return returnValue;
};

function LoadScript(url, callback) {

    var script = document.createElement("script")
    script.type = "text/javascript";

    if (script.readyState) {  //IE
        script.onreadystatechange = function () {
            if (script.readyState == "loaded" ||
                    script.readyState == "complete") {
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function () {
            callback();
        };
    }

    var filename = url.substring(url.lastIndexOf('/') + 1);

    for (var i = 0; i < document.scripts.length; i++) {
        if (document.scripts[i].src.indexOf(filename) > -1) {
            break;
        } else {
            script.src = url;
            document.getElementsByTagName("head")[0].appendChild(script);
            break;
        }
    }
}

function hasClass(element, cls) {
    return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
};

function addClass(elements, myClass) {
    if (!elements) {
        return;
    };

    if (typeof (elements) === 'string') {
        elements = document.querySelectorAll(elements);
    } else if (elements.tagName) {
        elements = [elements];
    };

    for (var i = 0; i < elements.length; i++) {
        if ((' ' + elements[i].className + ' ').indexOf(' ' + myClass + ' ') < 0) {
            elements[i].className += ' ' + myClass;
        };
    };
};

function removeClass(elements, myClass) {
    if (!elements) {
        return;
    };

    if (typeof (elements) === 'string') {
        elements = document.querySelectorAll(elements);
    } else if (elements.tagName) {
        elements = [elements];
    };

    var reg = new RegExp('(^| )' + myClass + '($| )', 'g');
    for (var i = 0; i < elements.length; i++) {
        elements[i].className = elements[i].className.replace(reg, '');
    };
};

function addAttr(elements, attrT, attrC) {
    if (!elements) {
        return;
    };

    if (typeof (elements) === 'string') {
        elements = document.querySelectorAll(elements);
    } else if (elements.tagName) {
        elements = [elements];
    };

    for (var i = 0; i < elements.length; i++) {
        elements[i].setAttribute(attrT, attrC);
    };
};

function indexInParent(el) {
    var children = el.parentNode.childNodes;
    var num = 0;
    for (var i = 0; i < children.length; i++) {
        if (children[i] === el) {
            return num;
        };
        if (children[i].nodeType === 1) {
            num++;
        };
    };
    return -1;
};

function getParamAddUrl(linkURL, isMain, paramNM, index) {
    try {

        var baseurl = linkURL;
        var hashurl = "";
        if (linkURL.indexOf("#") > 0) {
            baseurl = linkURL.substring(0, linkURL.indexOf("#"));
            hashurl = linkURL.substring(linkURL.indexOf("#"));
        }

        if (linkURL.indexOf("?") > 0)
            return baseurl + "&mbn=" + isMain + "&mln=" + paramNM + "_" + (index + 1) + hashurl;
        else
            return baseurl + "?mbn=" + isMain + "&mln=" + paramNM + "_" + (index + 1) + hashurl;
    } catch (e) {
        return linkURL;
    }
}

function AddParam(link, param) {
    if (link.indexOf('?') > -1) {
        return (link + "&" + param);
    }
    else {
        return (link + "?" + param);
    }
}

function getReplaceStr(str) {
    try {
        if (str != "" && str != "undefined" && str != null) {
            return str.replace(/\'/gi, "′").replace(/\"/gi, "″");
        }
        else {
            return "";
        }
    }
    catch (e) { }

}

function replaceSSLUrl(str) {
    var openServerPrefix = "http://openimage.interpark.com";
    var sslServerPrefix = "https://sslimage.interpark.com";

    if (isHTTPS) {
        while (str.indexOf(openServerPrefix) != -1) {
            str = str.replace(openServerPrefix, sslServerPrefix);
        }
    }
    return str;
}

function replaceSSLHttps(str) {
    var openServerPrefix = "http://";
    var sslServerPrefix = "https://";
    if (isHTTPS) {
        while (str.indexOf(openServerPrefix) != -1) {
            str = str.replace(openServerPrefix, sslServerPrefix);
        }
    }
    return str;
}

/* ---------------------------------------------------------------------------------------------------------
// 톡집사
--------------------------------------------------------------------------------------------------------- */

// 톡집사 해쉬태그 
function ExcuteTalkEnterModule() {
    var strLoginYN = getLoginYN();
    if (strLoginYN == "Y") {
        if (location.hash != "#talk")
        {
            RemoveHash();
            if (history.pushState) {
                history.pushState(null, null, '#talk');
            }
            else {
                location.hash = '#talk';
            }
        }
    }
    else {
        RemoveHash();

        if (history.pushState) {
            history.pushState(null, null, '#talk');
        }
        else {
            location.hash = '#talk';
        }
    }

    TalkEnterModule.Start();
}

function ExcuteTalkEnterModuleFiexed() {
    var strLoginYN = getLoginYN();
    if (strLoginYN == "Y") {
        if (location.hash != "#talkFixed") {
            RemoveHash();

            if (history.pushState) {
                history.pushState(null, null, '#talkFixed');
            }
            else {
                location.hash = '#talkFixed';
            }
        }
    }
    else {
        RemoveHash();

        if (history.pushState) {
            history.pushState(null, null, '#talkFixed');
        }
        else {
            location.hash = '#talkFixed';
        }
    }

    TalkEnterModule.OAStart('단체/법인여행 문의', '100003oaT3394', 'overseas_tour');
}

function RemoveHash() {
    if (location.hash != "#talk" && location.hash != "#talkFixed")
        return;

    if (history.pushState) {
        history.pushState("", document.title, window.location.pathname + window.location.search);
    }
    else {
        location.hash = '#';
    }
}

//concierge talk common popup
LoadScript(location.protocol + "//tour.interpark.com/Scripts/Views/Iframe/ConciergeSMSPopup.js", function () {
    // concierge talk web version
    LoadScript(location.protocol + "//talk-tour.interpark.com/global/js/entertalk.js", function () {
        var strLoginYN = getLoginYN();
        if (strLoginYN == "N") {
            RemoveHash();
            return;
        }

        if (location.hash == "#talk")
            TalkEnterModule.Start();
        else if (location.hash == "#talkFixed")
            TalkEnterModule.OAStart('단체/법인여행 문의', '100003oaT3394', 'overseas_tour');
        
    })
})

/* ---------------------------------------------------------------------------------------------------------
// ui_header.js에서 이식 : menu common
--------------------------------------------------------------------------------------------------------- */

var hoverMenu = function (el) {
    if (!hasClass(el, 'active')) {
        addClass(el, 'active');
        addAttr(el.querySelector('.sub-menu'), 'aria-hidden', false);
    };
};

var outMenu = function (el) {
    if (hasClass(el, 'active')) {
        removeClass(el, 'active');
        addAttr(el.querySelector('.sub-menu'), 'aria-hidden', true);
    }
};

var blurMenu = function () {
    var wrap = document.querySelector('.menu-area');
    var searchBtn = document.querySelector('.search-btn');
    var logoBox = document.querySelector('.logo-box .interpark');
    var autocomplete = document.querySelector('.autoComBox');
    var searchword = document.querySelector('.seaQueryBox');
    if (wrap === null) {
        return false;
    }
    var nextElement = wrap.querySelector('.gnb-box.event a') || document.querySelector('.gate-cover a') || document.querySelector('.ui-gate-section a') || document.querySelector('.ui-gate-section1 a');
    var links = wrap.querySelector('a');
    var sto;

    function blurs() {
        var active = document.querySelector('.menu-area dd.active');
        if (active !== null) {
            removeClass(active, 'active');
            addAttr(active.querySelector('.sub-menu'), 'aria-hidden', true);
        }
    }

    links.onfocus = function () {
        blurs();
    };
    if (nextElement !== null) {
        nextElement.onfocus = function () {
            blurs();
        };
    }
    logoBox.onfocus = function () {
        autocomplete.style.display = 'none';
        searchword.style.display = 'none';
    };
    searchBtn.onfocus = function () {
        autocomplete.style.display = 'none';
        searchword.style.display = 'none';
    };
};

var focusMenu = function (el) {
    var grids = el.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
    var grid_item = grids.querySelectorAll('dd');
    var grid_length = grid_item.length;
    for (var i = 0; i < grid_length; i++) {
        addAttr(grid_item[i].querySelector('.sub-menu'), 'aria-hidden', true);
        removeClass(grid_item[i], 'active');
    };
    addClass(el.parentNode.parentNode, 'active');
    addAttr(el.parentNode.parentNode.querySelector('.sub-menu'), 'aria-hidden', false);
};

function show_glayer(layer_id, index) {
    var element = document.getElementById(layer_id);
    if (element) {
        element.style.display = '';
    }

    CloseAllMenuLayers();
    document.getElementById(layer_id).style.display = 'block';
}

function hide_glayer(layer_id) {
    var element = document.getElementById(layer_id);
    if (element) {
        element.style.display = 'none';
    }
}

function hide_glayerForGnbSubPopup(layer_id, e) {
    var cursorX = 0;
    var cursorY = 0;

    cursorX = e.pageX;
    cursorY = e.pageY;

    if (typeof e.pageX === 'undefined' && typeof e.pageY === 'undefined') {
        cursorX = e.clientX;
        cursorY = e.clientY;
    }

    var rect = document.getElementById(layer_id).getBoundingClientRect();

    if (cursorX < rect.left || cursorX >= rect.right || cursorY >= rect.bottom) {
        document.getElementById(layer_id).style.display = 'none';
    }
}

function hide_glayerForGnbTitle(layer_id, ele, e) {
    var cursorX = 0;
    var cursorY = 0;

    cursorX = e.pageX;
    cursorY = e.pageY;

    if (typeof e.pageX === 'undefined' && typeof e.pageY === 'undefined') {
        cursorX = e.clientX;
        cursorY = e.clientY;
    }

    var rect = ele.getBoundingClientRect();
    if (cursorX < rect.left || cursorY < rect.top || cursorX >= rect.right) {
        document.getElementById(layer_id).style.display = 'none';
    }
}

function CloseAllMenuLayers() {
    hide_glayer('_cat_sub01');
    hide_glayer('_cat_sub02');
    hide_glayer('_cat_sub03');
    hide_glayer('_cat_sub04');
    hide_glayer('_cat_sub08');
    hide_glayer('_cat_sub09');
    hide_glayer('_cat_sub10');
    hide_glayer('_cat_sub11');
    hide_glayer('_cat_sub12');
    hide_glayer('_cat_sub13');
    hide_glayer('_cat_sub14');
    hide_glayer('_cat_sub35');
}

/* ---------------------------------------------------------------------------------------------------------
// 탑배너 - ???
--------------------------------------------------------------------------------------------------------- */

function TopBannerHide() {
    hide_glayer('divTop_Banner');
}

/* ---------------------------------------------------------------------------------------------------------
// 헬로우배너
--------------------------------------------------------------------------------------------------------- */

function uiSlider(opt) {
    var fn = {
        // 변수
        _variables: {
            time: 3000, //롤링 타임
            sti: '', //setInterval을 담을 변수
            switchs: false, // 정지여부
            slideWrap: '',
            item: '',
            playBtn: '', //일시정지버튼
            item_length: '',
            firstNum: 0, // 처음 노출될 아이템 index,
            idx: '', // 진행중인 아이템 index
            random: false
        },
        _findDom: function (el) {
            if (el !== null) {
                this._variables.slideWrap = el;
                this._variables.item = this._variables.slideWrap.querySelectorAll('.item');
                this._variables.playBtn = this._variables.slideWrap.querySelector('.switch');
                this._variables.item_length = this._variables.item.length;
            };
        },
        // 기본펑션
        _default: function (opt) {
            if (opt !== undefined) {
                if (opt.time !== undefined) {
                    this._variables.time = opt.time;
                }
                if (opt.random !== undefined) {
                    this._variables.random = opt.random;
                }
                if (opt.slideWrap !== undefined) {
                    this._findDom(opt.slideWrap);
                }
                if (opt.btn !== undefined) {
                    // 버튼
                    this._variables.playBtn.onclick = function () {
                        fn._playBtn(this);
                    };
                }
                if (opt.hover !== undefined) {
                    // 호버
                    for (var i = 0; i < this._variables.item_length; i++) {
                        this._variables.item[i].querySelector('a').onmouseover = function () {
                            fn._hover(this);
                        };
                    }
                }
                if (opt.focus !== undefined) {
                    // 포커스
                    for (var i = 0; i < this._variables.item_length; i++) {
                        this._variables.item[i].querySelector('a').onfocus = function () {
                            fn._hover(this);
                        };
                    }
                }
            };

            if (this._variables.random === true) {
                this._variables.firstNum = this._random(this._variables.item_length);
            };

            this._variables.idx = this._variables.firstNum;
            addClass(this._variables.item[this._variables.firstNum], 'current');
            this._slide();
        },
        // 첫 화면의 슬라이드 렌덤 시작
        _random: function (length) {
            var data = Math.floor(Math.random() * length);
            return data;
        },
        // 슬라이드 멈춤
        _switchOff: function () {
            clearInterval(this._variables.sti);
            removeClass(this._variables.slideWrap, 'doing');
        },
        // 슬라이드 재생 _switchOn
        _slide: function () {
            clearInterval(this._variables.sti);
            addClass(this._variables.slideWrap, 'doing');
            // setItv 안에서 this는 window. this 대신 fn로 사용함.
            this._variables.sti = setInterval(function () {
                if (fn._variables.idx <= fn._variables.item_length - 2) {
                    fn._variables.idx += 1;
                } else {
                    fn._variables.idx = 0;
                };

                fn._slideTo();
            }, this._variables.time);
        },
        // 해당 슬라이드 이동
        _slideTo: function () {
            for (var i = 0; i < this._variables.item_length; i++) {
                if (i !== this._variables.idx) {
                    removeClass(this._variables.item[i], 'current');
                };
            };

            addClass(this._variables.item[this._variables.idx], 'current');
        },
        // 마우스 오버 시 실행할 펑션들
        _hover: function (el) {
            if (this._variables.slideWrap === '') {
                this._findDom(el);
            };
            if (!this._variables.switchs) {
                // 해당 이벤트 시 슬라이드 타임 초기화하기 위해 버튼 클릭 여부 체크 및 재실행
                this._slide();
            };
            this._variables.idx = indexInParent(el.parentNode);
            this._slideTo();
        },
        // 슬라이드영역 마우스 인 시 실행할 펑션들
        _boxIn: function () {
            if (!this._variables.switchs) {
                clearInterval(this._variables.sti);
            };
        },
        // 슬라이드영역 마우스 아웃 시 실행할 펑션들
        _boxOut: function () {
            if (!this._variables.switchs) {
                this._slide();
            };
        },
        // 탭키 접근 시 실행할 펑션들
        _focus: function (el) {
            if (this._variables.slideWrap === '') {
                this._findDom(el);
            };
            if (!this._variables.switchs) {
                // 해당 이벤트 시 슬라이드 타임 초기화하기 위해 버튼 클릭 여부 체크 및 재실행
                this._slide();
            };
            this._variables.idx = indexInParent(el.parentNode);
            this._slideTo();
        },
        // play버튼, switch 클릭 시
        _playBtn: function (el) {
            if (this._variables.playBtn === null) {
                this._findDom(el.parentNode);
            };
            this._variables.switchs = !this._variables.switchs;
            if (!this._variables.switchs) {
                this._slide();
                this._variables.playBtn.innerHTML = '일시정지';
                this._variables.playBtn.setAttribute('title', '일시정지');
            } else {
                this._switchOff();
                this._variables.playBtn.innerHTML = '재생';
                this._variables.playBtn.setAttribute('title', '재생');
            };
        }
    };
    fn._default(opt);
}

/* ---------------------------------------------------------------------------------------------------------
// Ready/Onload
--------------------------------------------------------------------------------------------------------- */

var domIsReady = (function (domIsReady) {
    var isBrowserIeOrNot = function () {
        return (!document.attachEvent || typeof document.attachEvent === 'undefined' ? 'not-ie' : 'ie');
    };

    domIsReady = function (callback) {
        if (callback && typeof callback === 'function') {
            if (isBrowserIeOrNot() !== 'ie') {
                document.addEventListener('DOMContentLoaded', function () {
                    return callback();
                });
            } else {
                document.attachEvent('onreadystatechange', function () {
                    if (document.readyState === 'complete') {
                        return callback();
                    }
                });
            }
        } else {
            console.error('The callback is not a function!');
        }
    };

    return domIsReady;
})(domIsReady || {});

(function (document, window, domIsReady, undefined) {
    domIsReady(function () {

        blurMenu();

    });
})(document, window, domIsReady);


/* ---------------------------------------------------------------------------------------------------------
// EGS 코드 추가 내용 :: START 
--------------------------------------------------------------------------------------------------------- */

/* EGS 추가, 201705 AUTOCOMPLETE */
function EGS_Autocomplete(category, itemNo) {
    try {
        // 페이지 구분
        var action = "footer_loading";
        if ((typeof _EGS_HOME) != "undefined" && _EGS_HOME == "home") {
            action = "home";
        }
        // 검색어
        var searchStr = document.getElementById("SearchGNBText").value;

        EGS_SendLog(action, "autocomplete", searchStr, category, itemNo);
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 BTN_SEARCH */
function EGS_BtnSearch() {
    try {
        // 페이지 구분
        var action = "footer_loading";
        if ((typeof _EGS_HOME) != "undefined" && _EGS_HOME == "home") {
            action = "home";
        }
        // 검색어
        var searchStr = document.getElementById("SearchGNBText").value;

        EGS_SendLog(action, "btn_search", searchStr, "", "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 RECOMMEND */
function EGS_Recommend(search) {
    try {
        EGS_SendLog("search_result", "recommend", search, "", "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 TOP_TAB */
function EGS_TOP_TAB(section_info) {
    try {
        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        EGS_SendLog("search_result", "top_tab", searchStr, "", "", section_info);
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 CATEGORY */
function EGS_CATEGORY(category) {
    try {
        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        EGS_SendLog("search_result", "category", searchStr, category, "", "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 BTN_SEARCHFILTER */
function EGS_BtnSearchFilter(search) {
    try {
        EGS_SendLog("search_result", "btn_searchfilter", search, "", "", "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 BTN_SECTION_MORE */
function EGS_BtnSectionMore(category) {
    try {
        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        EGS_SendLog("search_result", "btn_section_more", searchStr, category, "", "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 BTN_PAGE_NO_CLICK */
function EGS_BtnPageNoClick(search_page_no) {
    //{search:검색어,search_page_no: 하단 검색 결과 페이징 번호,section_info:"section코드 참조"}
    try {
        // 페이징 번호
        search_page_no = parseInt(search_page_no) + 1;

        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        // SECTION_INFO
        var section_info_key = jQuery(".travle-module.on").attr("id").replace("divSearchResult", "");
        var section_info = "";
        switch (section_info_key) {
            case "E": // 땡처리항공
                section_info = "tour_airsale";
                break;
            case "O": // 해외호텔
                section_info = "tour_hotel";
                break;
            case "H": // 국내숙박
                section_info = "tour_housing";
                break;
            case "R": // 해외여행
                section_info = "tour_overseas";
                break;
            case "T": // 국내여행
                section_info = "tour_domestic";
                break;
            case "V": // 이벤트/기획전
                section_info = "tour_event";
                break;
            case "F": // 자주묻는 질문
                section_info = "tour_faq";
                break;
        }

        EGS_SendLog("search_result", "btn_page_no_click", searchStr, section_info_key, "", section_info, search_page_no.toString());
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 검색페이지 SEARCHCONTENTS */
function EGS_SearchContents(section_info_key) {
    //{search : 검색어,section_info:"section코드 참조"}

    try {
        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        // SECTION_INFO
        var section_info = "";
        switch (section_info_key) {
            case "E": // 땡처리항공
                section_info = "tour_airsale";
                break;
            case "O": // 해외호텔
                section_info = "tour_hotel";
                break;
            case "H": // 국내숙박
                section_info = "tour_housing";
                break;
            case "R": // 해외여행
                section_info = "tour_overseas";
                break;
            case "T": // 국내여행
                section_info = "tour_domestic";
                break;
            case "V": // 이벤트/기획전
                section_info = "tour_event";
                break;
            case "F": // 자주묻는 질문
                section_info = "tour_faq";
                break;
        }

        EGS_SendLog("search_result", "SearchContents", searchStr, "", "", section_info, "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 BTN_CUSTOM_SEARCH */
function EGS_BtnCustomSearch() {
    try {
        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        EGS_SendLog("search_result", "btn_custom_search", searchStr, "", "", "", "");
    } catch (ex) {
        EGS_Log(ex.message);
    }
    return true;
}
/* EGS 추가, 201705 SENDLOG EVENT */
function EGS_SendLog(action, section_id, search, category, itemNo, section_info, search_page_no) {
    var __EGS_DATAOBJ = {};
    try {
        __EGS_DATAOBJ = {
            "tagging": "tour.event.click",
            "action": action,
            "site": "tour.pcweb",
            "section_id": section_id
        };
        // 검색어
        if (search != undefined && search.length > 0) {
            __EGS_DATAOBJ["search"]= search;
        }
        // 분류번호
        if (category != undefined && category.length > 0) {
            __EGS_DATAOBJ["category_no"] = category;
        }
        // 상품번호
        if (itemNo != undefined && itemNo.length > 0) {
            __EGS_DATAOBJ["item_no"] = itemNo;
        }
        // SECTION_INFO
        if (section_info != undefined && section_info.length > 0) {
            __EGS_DATAOBJ["section_info"] = section_info;
        }
        // 페이징 번호
        if (search_page_no != undefined && search_page_no.length > 0) {
            __EGS_DATAOBJ["search_page_no"] = search_page_no;
        }

        EGS_Log(__EGS_DATAOBJ);

        EsLogMinor.sendLog(__EGS_DATAOBJ);

    } catch (ex) {
        EGS_Log(ex.message);
    }

    return true;
}
/* EGS 추가, 201705 SENDLOG VIEW */
function EGS_SendLogView(result_count) {
    var __EGS_DATAOBJ = {};
    try {
        // 검색어
        var searchStr = document.getElementById("queryName").innerText;

        __EGS_DATAOBJ = {
            "tagging": "tour.action.view",
            "action": "search_result",
            "site": "tour.pcweb",
            "search": searchStr,
            "result_count": result_count
        };
        EGS_Log(__EGS_DATAOBJ);
        EsLogMinor.sendLog(__EGS_DATAOBJ);

    } catch (ex) {
        EGS_Log(ex.message);
    }

    return true;
}

function EGS_Log(str) {
    try {
        console.log(str);
    }
    catch (ex) { }
}
